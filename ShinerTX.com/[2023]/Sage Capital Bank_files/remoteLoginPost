window.io_global_object_name="IGLOO";window.IGLOO=window.IGLOO||{enable_flash:!1,loader:{fp_static:!1,fp_dyn:!1,version:"general5"}};PBI=PBI||{};PBI.deviceFingerprint=function(){var n=window.IGLOO;return n&&n.getBlackbox&&typeof n.getBlackbox=="function"?n.getBlackbox().blackbox:null},function A(){function o(n,t){for(var r={},i=n.length-1;-1<i;i--)0<i?r[i]=function(){var u=i;return function(){return s(n[u],r[u+1],t)}}():s(n[i],r[i+1],t)}function s(r,u,f){var e=document.createElement("script"),o=r[0].split("?")[0].split("/"),s;s=o[o.length-1].split(".")[0];o=n[f]&&n[f].staticVer&&n[f].staticVer+"/"||r[1];/([0-9]+\.){2}[0-9]+\//.test(r[1])&&o!==r[1]&&i("loader: Overriding configured version with staticVer.");r[0]=r[0].replace("##version##",o);e.setAttribute("src",r[0]);e&&e.addEventListener?e.addEventListener("error",function(){t[f+"_"+s+"_load_failure"]="true"}):e.attachEvent&&e.attachEvent("onerror",function(){t[f+"_"+s+"_load_failure"]="true"});u&&(e.onload=u);document.getElementsByTagName("head")[0].appendChild(e)}function i(t){if("function"==typeof n.trace_handler)try{n.trace_handler(t)}catch(i){}}function r(n,t){var i=null!==n&&void 0!==n;return!i||"1"!==n.toString()&&"true"!==n.toString().toLowerCase()?!i||"0"!==n.toString()&&"false"!==n.toString().toLowerCase()?"boolean"==typeof t?t:!1:!1:!0}var u=window,h=u.io_global_object_name||"IGLOO",n=u[h]=u[h]||{},t=n.loader=n.loader||{},f=[],e=[];if(t.loaderMain)return i("loader: Loader script has already run, try reducing the number of places it's being included."),!1;t.loaderMain=A;t.loaderVer="5.1.0",function(){var p=r(t.tp,!0),v=r(t.fp_static,!0),w=r(t.fp_dyn,!0),b=r(t.enable_legacy_compatibility),k=r(t.tp_split),d=t.tp_host&&t.tp_host.replace(/\/+$/,"")||"https://mpsnare.iesnare.com",y=t.fp_static_override_uri,s=void 0!==t.uri_hook?t.uri_hook+"/":"/iojs/",h=(t.version||"versionOrAliasIsRequired")+"/",g=t.subkey?u.encodeURIComponent(t.subkey)+"/":"",nt=t.tp_resource||"wdp.js",c=t.tp_host?"&tp_host="+u.encodeURIComponent(t.tp_host):"",tt=y?"&fp_static_uri="+u.encodeURIComponent(y):"",l,a,o;t.tp_host=d;l=r(n.enable_flash,!0);a=n.io&&n.io.enable_flash;o=n.fp&&n.fp.enable_flash;a=void 0!==a&&null!==a?r(a,!0):l;void 0!==o&&null!==o?o=r(o,!0):a=l;l=a?"&flash=true":"&flash=false";o=o?"&flash=true":"&flash=false";c="?loaderVer="+t.loaderVer+"&compat="+b+"&tp="+p+"&tp_split="+k+c+"&fp_static="+v+"&fp_dyn="+w+tt;p||v||i("loader: Not currently configured to load fp_static or tp script(s).");n.fp&&n.fp.staticVer&&n.fp.staticVer+"/"!==h&&(h=n.fp.staticVer+"/",i("loader: Configured version replaced with that from pre-loaded static script."));v||n.fp&&n.fp.staticMain?(s=(s+"##version##"+g).replace(/\/\//g,"/"),v&&(n.fp&&n.fp.staticMain?b&&!n.fp.preCompatMain&&i("loader: enable_legacy_compatibility on, but included static does not have the compat wrapper."):y?f.push([y,""]):f.push([s+"static_wdp.js"+c+o,h])),!w||n.fp&&n.fp.dynMain?n.fp&&n.fp.dynMain&&i("loader: First party dynamic script has already been loaded, disable fp_dyn or make sure you're not manually including the dynamic file separately."):f.push([s+"dyn_wdp.js"+c+o,h])):r(t.fp_dyn)&&i("loader: Invalid Config, first party dynamic script set to load without static.");p&&(n.io&&n.io.staticMain?i("loader: Third party script has already been loaded."):(s=d+"/##version##"+g,k?(e.push([s+"static_wdp.js"+c+l,h]),e.push([s+"dyn_wdp.js"+c+l,h]),t.tp_resource&&i("loader: Invalid Config: both tp_resource and tp_split set. Ignoring tp_resource.")):e.push([s+nt+c+l,h])))}();o(f,"fp");o(e,"io")}();"use strict";var PBI=PBI||{};PBI.RemoteLoginPost=function(n){function i(n,i){Array.prototype.forEach.call(t.formElement.elements,function(i){i.name===n&&t.formElement.removeChild(i)});var r=document.createElement("input");r.setAttribute("type","hidden");r.setAttribute("name",n);r.setAttribute("value",i);t.formElement.appendChild(r)}var t=this;n.applicationPath&&n.formId&&n.passwordId&&n.routingTransit&&n.usernameId&&(t.formElement=document.getElementById(n.formId),t.usernameElement=document.getElementById(n.usernameId),t.passwordElement=document.getElementById(n.passwordId),t._applicationPath=n.applicationPath,n.applicationPath.substr(n.applicationPath.length-1)!=="/"&&(t._applicationPath+="/"),t.formElement.addEventListener("submit",function(){t.formElement.setAttribute("action",t._applicationPath+"Login/RemoteSubmit/"+n.routingTransit+(n.themeNumber?"/"+n.themeNumber:""));t.formElement.setAttribute("method","POST");t.usernameElement.setAttribute("name","username");t.passwordElement.setAttribute("name","password");var r=new Date,u=null;typeof PBI.deviceFingerprint=="function"&&(u=PBI.deviceFingerprint());i("maskLoginInputs",t.usernameElement.type==="password");i("fingerprint",u);i("pluginCount",navigator.plugins.length);i("timezoneOffset",r.getTimezoneOffset());i("timestampUtc",r.toUTCString())}))}