 if (document.createStyleSheet) { document.createStyleSheet('https://cdn.customerconnections.io/css/PDLFooter.css?vs=4'); } else { var child2 = document.createElement("div"); child2.innerHTML = "<link rel='stylesheet' href='https://cdn.customerconnections.io/css/PDLFooter.css?vs=4' type='text/css' media='screen' />"; if(document.getElementsByTagName('body')[0] == null){document.getElementsByTagName('head')[0].appendChild(child2); } else {document.getElementsByTagName('body')[0].appendChild(child2); }} var convert = {toNumber: function(str) {return str.replace(/[^0-9]/gi, '');},toTenDigits: function(str) {return str.substring(0, 10);}};function getCookie(c_name) { var c_value = document.cookie; var c_start = c_value.indexOf(' ' + c_name + '='); if (c_start == -1) { c_start = c_value.indexOf(c_name + '='); } if (c_start == -1) { c_value = null; } else { c_start = c_value.indexOf('=', c_start) + 1; var c_end = c_value.indexOf(';', c_start); if (c_end == -1) { c_end = c_value.length; } c_value = unescape(c_value.substring(c_start,c_end)); } return c_value; } function LoadRecentlyViewedModal(data) { var divPSMWelcomeBackMain = document.createElement("div"); var html = "<div id='div-PSMWelcomeBackStart' class='psm-welcome-back-start psm-welcome-back-button psm-anchor-bottom'>[WelcomeBackFirstNameMessage]</div><div id='div-psm-welcome-back-bubble' class='psm-welcome-back-bubble border round'><span id='psm-welcome-back-start-close' class='psm-welcome-back-start-close'>&times;</span><div class='psm-welcome-back-text'><p><span class='psm-welcome-back-header'>[WelcomeBackFirstNameMessage]!</span></p><!-- Trigger/Open The Modal --><p><div id='btnPSMWelcomeBack' class='psm-welcome-back-button psm-welcome-back-button'>Recently Viewed Inventory</div></p><hr><span class='psm-welcome-back-other-text'>or view</span><div class='psm-welcome-back-other-options'><div id='psm-welcome-back-other-text-new-1' class='psm-welcome-back-other-text-new psm-welcome-back-button'>All New Inventory</div><div id='psm-welcome-back-other-text-po-1' class='psm-welcome-back-other-text-po psm-welcome-back-button'>All Pre-Owned Inventory</div></div></div></div><!-- The Modal --><div id='modal-psm-welcome-back' class='psm-welcome-back'><!-- Modal content --><div class='psm-welcome-back-content'><span id='btnPSMWelcomeBackClose' class='psm-welcome-back-close'>&times;</span><div class='psm-welcome-back-header'>[WelcomeBackText]</div><div class='psm-welcome-back-vehicles'>[HTMLForUser]</div><hr><div class='psm-welcome-back-other-options'><div id='psm-welcome-back-other-text-new' class='psm-welcome-back-other-text-new psm-welcome-back-button'>All New Inventory</div><div id='psm-welcome-back-other-text-po' class='psm-welcome-back-other-text-po psm-welcome-back-button'>All Pre-Owned Inventory</div></div></div></div>"; var nameMessage = 'Welcome Back'; if(data.firstName !== '') {{ nameMessage += ' ' + data.firstName; }} else {{ nameMessage = 'Recently Viewed Inventory'; }}html = html.replace('[WelcomeBackFirstNameMessage]', 'MY RECENTLY VIEWED INVENTORY'); html = html.replace('[WelcomeBackFirstNameMessage]', 'MY RECENTLY VIEWED INVENTORY'); html = html.replace('[WelcomeBackText]', nameMessage); html = html.replace('[WelcomeBackText]', nameMessage); var vehicleHtml = "<table width='100%'>"; for(var i = 0; i < data.vehicles.length; i++) { var vehicle = data.vehicles[i]; vehicleHtml += "<tr><td><img src='" + vehicle.image + "' alt='" + vehicle.title.replace('|||', '"') + "' /></td><td><span class='psm-wb-vehicle-title'>" + vehicle.title.replace('|||', '"') + "</span><br /><span class='psm-wb-vehicle-link'><a onclick='psmSendTealiumEvent(&apos;rvi_product_page_click&apos;)' href='" + vehicle.url + "' target='_blank'>View Again</a></span></td></tr>"; } vehicleHtml += "</table>"; html = html.replace('[HTMLForUser]', vehicleHtml); divPSMWelcomeBackMain.innerHTML = html; var psmWelcomeBackCSS = document.createElement("div"); psmWelcomeBackCSS.innerHTML = "<link rel='stylesheet' href='https://cdn.customerconnections.io/css/psmwb.css?vs=4' type='text/css' media='screen' />"; if(document.getElementsByTagName('body')[0] == null) {document.getElementsByTagName('head')[0].appendChild(psmWelcomeBackCSS); } else {document.getElementsByTagName('body')[0].appendChild(psmWelcomeBackCSS); } document.body.appendChild(divPSMWelcomeBackMain); var divWBStart = document.getElementById('div-PSMWelcomeBackStart'); var PSMWelcomeBackStartContainer = document.getElementById('div-PSMWelcomeBackStart'); var PSMWelcomeBackStartPopBubble = document.getElementById('div-psm-welcome-back-bubble'); var windowWidth = window.innerWidth;if(PSMWelcomeBackStartContainer) { if(windowWidth > 767) {PSMWelcomeBackStartContainer.style.cssText += ';left: 30px !important; ' } else {PSMWelcomeBackStartContainer.style.cssText += ' ;transform: rotate(90deg);left: -98px; bottom: 120px; border-radius: 6px 6px 0px 0; !important; ' }} if(PSMWelcomeBackStartPopBubble) { PSMWelcomeBackStartPopBubble.style.cssText += ';left: 30px !important; ' } var PSMWelcomeBackModalMinimizedYet = false; if (document.cookie.indexOf('PSMRVIWidgetScreenShown=1') > 0) { PSMWelcomeBackModalMinimizedYet = true; } if (!PSMWelcomeBackModalMinimizedYet) { PSMWelcomeBackModalMinimizedYet = true; var dateOfExp = new Date(); dateOfExp.setDate(dateOfExp.getDate() + 1); document.cookie = 'PSMRVIWidgetScreenShown=1; path=/; Expires=' + dateOfExp.toString(); if(divWBStart) { divWBStart.style.display = 'block'; } } else { var widget = document.getElementById('modal-psm-welcome-back'); widget.style.display = 'none'; if(divWBStart) { divWBStart.style.display = 'block'; } }document.addEventListener('click', function(e) { if(e.target && e.target.id === 'modal-psm-welcome-back') { var divWBModal = document.getElementById('modal-psm-welcome-back'); if(divWBModal) { if(divWBModal.style.display === 'block') { divWBModal.style.display = 'none'; }  var divWBStart = document.getElementById('div-PSMWelcomeBackStart'); divWBStart.style.display = 'block'; } } }); document.addEventListener('click', function(e){ if(e.target && e.target.id== 'div-PSMWelcomeBackStart') { var divWBStart = document.getElementById('div-PSMWelcomeBackStart'); var wbDiv = document.getElementById('modal-psm-welcome-back'); wbDiv.style.display = 'block'; divWBStart.style.display = 'none'; psmSendTealiumEvent('rvi_launcher_click'); } }); document.addEventListener('click', function(e){ if(e.target && e.target.id== 'psm-welcome-back-start-close') { var closeStartModel = document.getElementById('psm-welcome-back-start-close'); var divWBStart = document.getElementById('div-PSMWelcomeBackStart'); var wbDiv = document.getElementById('div-psm-welcome-back-bubble'); wbDiv.style.display = 'none'; divWBStart.style.display = 'block'; } }); document.addEventListener('click', function(e){ if(e.target && e.target.id== 'btnPSMWelcomeBack') { var modal = document.getElementById('modal-psm-welcome-back'); modal.style.display = 'block'; psmSendTealiumEvent('rvi_launch_widget_recently_viewed_inventory_click'); } }); document.addEventListener('click', function(e){ if(e.target && e.target.id== 'btnPSMWelcomeBackClose') { var modal = document.getElementById('modal-psm-welcome-back'); modal.style.display = 'none'; var divWBStart = document.getElementById('div-PSMWelcomeBackStart'); divWBStart.style.display = 'block'; } }); document.addEventListener('click', function(e){ if(e.target && e.target.id== 'psm-welcome-back-other-text-new') { psmSendTealiumEvent('rvi_primary_widget_new_inventory_click'); window.location = 'https://www.mowersuperstore.com/search/inventory/usage/New'; } }); document.addEventListener('click', function(e){ if(e.target && e.target.id== 'psm-welcome-back-other-text-new-1') { psmSendTealiumEvent('rvi_launch_widget_new_inventory_click'); window.location = 'https://www.mowersuperstore.com/search/inventory/usage/New'; } }); document.addEventListener('click', function(e){ if(e.target && e.target.id== 'psm-welcome-back-other-text-po') { psmSendTealiumEvent('rvi_primary_widget_preowned_inventory_click'); window.location = 'https://www.mowersuperstore.com/search/inventory/usage/Used'; } }); document.addEventListener('click', function(e){ if(e.target && e.target.id== 'psm-welcome-back-other-text-po-1') { psmSendTealiumEvent('rvi_launch_widget_preowned_inventory_click'); window.location = 'https://www.mowersuperstore.com/search/inventory/usage/Used'; } }); } function psmSendTealiumEvent(event) { console.log('tealium_event: ' + event); if (typeof utag === 'object') { if (typeof utag_data === 'object') { var psm_event_utag = utag_data; Object.keys(psm_event_utag).forEach(function (k) { if (k.startsWith('cp.')) { delete psm_event_utag[k]; } if (k.startsWith('ut.')) { delete psm_event_utag[k]; } }); psm_event_utag.tealium_event = event; utag.link(psm_event_utag); } } } function PSMOnboardResponseSuccess(visitorId) { console.log('onboarding-id: ' + visitorId); var dateOfExp = new Date(); dateOfExp.setDate(dateOfExp.getDate() + 1); document.cookie = 'OnboardCook32177=' + visitorId + '; path=/; Expires=' + dateOfExp.toString(); DisplayAndCheckHistory(visitorId); } function DisplayAndCheckHistory(visitorId) { var DealerWelcomeBackEnabled = true; if(DealerWelcomeBackEnabled) { var LoadVDPRecentChecker = 'https://cdn.customerconnections.io/LoadVDPHistoryModal.aspx?id=' + visitorId + '&dealerid=32177'; const OnboardURL = new XMLHttpRequest(); OnboardURL.open('GET', LoadVDPRecentChecker); OnboardURL.send(); OnboardURL.onload = () => { let status = OnboardURL.status; if (status == 200) { var data = JSON.parse(OnboardURL.responseText); if (data.success) { LoadRecentlyViewedModal(data);  } else { console.log(data.message); } } else { console.log(OnboardURL.responseText); } }; } else { console.log('PSM Dealer Welcome Back VDP Disabled'); } } var PSMReviewScript = document.createElement("script"); PSMReviewScript.innerHTML = " function ShowPSMReviewDetails(RatingImageURL, FullName, ReviewLevel, reviewComments, FacebookDateString, SourceURL, TypeText) { var psmReviewsModal = document.getElementById('psm-reviews-modal'); psmReviewsModal.style.display = 'block'; var psmReviewsModalContent = document.getElementById('psm-reviews-modal-content');var psmReviewsModalContentTemplate = document.getElementById('psm-reviews-modal-content-template');psmReviewsModalContent.innerHTML = psmReviewsModalContentTemplate.innerHTML.replace('[RatingImageURL]', RatingImageURL).replace('[FullName]', FullName).replace('[ReviewLevel]', ReviewLevel).replace('[reviewComments]', reviewComments).replace('[FacebookDateString]', FacebookDateString).replace('[TypeText]', TypeText).replace('[SourceURL]', SourceURL); var psmReviewsModalClose = document.getElementsByClassName('psm-reviews-modal-close')[0]; psmReviewsModalClose.onclick = function() {  psmReviewsModal.style.display = 'none'; } } "; if(document.getElementsByTagName('body')[0] == null) {document.getElementsByTagName('head')[0].appendChild(PSMReviewScript); } else {document.getElementsByTagName('body')[0].appendChild(PSMReviewScript); } var divPSMReviews =  document.getElementById('divLVRM-Reviews'); if (typeof(divPSMReviews) != 'undefined' && divPSMReviews != null) { var buttonhtml = '<div class="psm-review-container"><h1>Read What Our Customers Are Saying</h1><hr >'; divPSMReviews.style.display = 'block'; divPSMReviews.innerHTML = buttonhtml + '<div style="width: 600px; height: 300px; margin: 0 auto; text-align: center; margin-top: 60px;"><img src="https://psm.blob.core.windows.net/psmdata/Images/loading_transparent.gif" alt="Loading" /><br />Loading reviews...</div>'; var LoadReviewsURL = 'https://cdn.customerconnections.io/LoadReviews.aspx?id=dd201b47bbcd4a1faa7ff6590a9d03bf'; const ReviewDataURL = new XMLHttpRequest(); ReviewDataURL.open('GET', LoadReviewsURL); ReviewDataURL.send(); ReviewDataURL.onload = () => { let status = ReviewDataURL.status; if (status == 200) { var psmReviewCSS = document.createElement("div"); psmReviewCSS.innerHTML = "<link rel='stylesheet' href='https://cdn.customerconnections.io/css/psmreview.css?vs=3' type='text/css' media='screen' />"; if(document.getElementsByTagName('body')[0] == null) {document.getElementsByTagName('head')[0].appendChild(psmReviewCSS); } else {document.getElementsByTagName('body')[0].appendChild(psmReviewCSS); } divPSMReviews.style.display = 'block'; var data = JSON.parse(ReviewDataURL.responseText); if (data.success) { buttonhtml += '<div>'; buttonhtml += '</div>'; var reviewHtml = "<div class='psm-review-row-padding'>"; for(var i = 0; i < data.reviews.length; i++) { var review = data.reviews[i]; var Comments = review.CommentPreview; var reviewJSON = JSON.stringify(review); if(review.ShowMoreButton) { Comments += ' <br /><span style="cursor: pointer; padding-top:5px; display: block;" onclick="ShowPSMReviewDetails(\'' + review.RatingImageURL + '\', \'' + review.FullName + '\', \'' + review.Rating + '\', \'' + review.ReviewDescSafe.replace(/'/g, '') + '\', \'' + review.ReviewDateDisplay + '\',\'' + review.SourceURL + '\',\'' + review.TypeText + '\');"><u><b>Read Full Review</b></u></span>'; } reviewHtml += "<div class='psm-review-third'><img src='" + review.RatingImageURL + "' alt='" + review.Rating + "' /><br /><div class='psm-review-comments'>" + Comments + "</div><table width='100%' style='padding: 2px;'><tr><td><b>" + review.FullName + "</b><br />" + review.ReviewDateDisplay + "</td><td align='right'><img height='30' src='" + review.SourceURL + "' alt='" + review.TypeText + "' /></td></tr></table></div>"; } reviewHtml += "</div>"; buttonhtml += reviewHtml; buttonhtml += "<div id='psm-reviews-modal' class='psm-reviews-modal'>"; buttonhtml += "<div class='psm-reviews-modal-content'>"; buttonhtml += "<span class='psm-reviews-modal-close'>&times;</span>"; buttonhtml += "<div id='psm-reviews-modal-content-template' style='display:none;'><div class='psm-review-third'><img src='[RatingImageURL]' alt='[ReviewLevel]' /><br /><div class='psm-review-comments'>[reviewComments]</div><table width='100%'><tr><td><b>[FullName]</b><br />[FacebookDateString]</td><td align='right'><img height='30' src='[SourceURL]' alt='[TypeText]' /></td></tr></table></div> </div>"; buttonhtml += "<div id='psm-reviews-modal-content'></div>"; buttonhtml += "</div>"; buttonhtml += "</div>"; buttonhtml += "</div>"; divPSMReviews.innerHTML = buttonhtml; } else { console.log(data.message); divPSMReviews.innerHTML = '<div style="width: 600px; height: 300px; margin: 0 auto; text-align: center; margin-top: 60px;">' + data.message + '</div>'; } } else { console.log(ReviewDataURL.responseText); divPSMReviews.innerHTML = '<div style="width: 600px; height: 300px; margin: 0 auto; text-align: center; margin-top: 60px;">' + ReviewDataURL.responseText + '</div>'; } }; } var LoadOnboardScript = 0; var PSMOnboardCookie = getCookie('OnboardCook32177'); if (PSMOnboardCookie != null && PSMOnboardCookie != '') { LoadOnboardScript = 1; } var psm_wb_font = new FontFace('Bebas Neue', 'url(https://cdn.customerconnections.io/css/BebasNeue-Regular.ttf)'); psm_wb_font.load().then(function(psm_Bebas_Neue_face) { document.fonts.add(psm_Bebas_Neue_face); }).catch(function(error) { }); if (LoadOnboardScript == 0) { const fpPromise = new Promise((resolve, reject) => { const script = document.createElement('script'); script.onload = resolve; script.onerror = reject; script.async = true; script.src = 'https://cdn.jsdelivr.net/npm/@fingerprintjs/fingerprintjs-pro@3/dist/fp.min.js'; document.head.appendChild(script); }) .then(() => FingerprintJS.load({ token: '8SMYTmlRdqyGTGMYPwF5', endpoint: 'https://metrics.psmmarketing.com' })); const requestMetadata = { dealerid: 32177, requestType: 'onboard' }; fpPromise .then(fp => fp.get({ tag: requestMetadata })) .then(result => PSMOnboardResponseSuccess(result.visitorId)) .catch(error => console.log(error.message)); } else { console.log('prior onboarding-id: ' + PSMOnboardCookie); DisplayAndCheckHistory(PSMOnboardCookie); const url = 'https://onboard.localwebdominator.com/OnboardVisit.aspx?Id=' + PSMOnboardCookie + '&DealerId=32177&Page=' + encodeURIComponent(window.location.href); const OnboardURL = new XMLHttpRequest(); OnboardURL.open('GET', url); OnboardURL.send(); OnboardURL.onload = () => { let status = OnboardURL.status; if (status == 200) { var data = JSON.parse(OnboardURL.responseText); if (data.success) { console.log('Onboarded page for ' + PSMOnboardCookie); } else { console.log(data.html); } } else { console.log(OnboardURL.responseText); } }; } function include(filename, onload) { var head = document.getElementsByTagName('head')[0]; var script = document.createElement('script'); script.src = filename; script.type = 'text/javascript'; script.onload = script.onreadystatechange = function () { if (script.readyState) { if (script.readyState === 'complete' || script.readyState === 'loaded') { script.onreadystatechange = null; onload(); } } else { onload(); } }; head.appendChild(script); }; function css(selector, property, value) { for (var i = 0; i < document.styleSheets.length; i++) { try { document.styleSheets[i].insertRule(selector + ' {' + property + ':' + value + '}', document.styleSheets[i].cssRules.length); } catch (err) { try { document.styleSheets[i].addRule(selector, property + ':' + value); } catch (err) { } } } }  