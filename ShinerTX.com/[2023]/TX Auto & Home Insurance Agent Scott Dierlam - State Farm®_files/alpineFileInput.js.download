(()=>{window.initFileInput=function(){return{attachmentButtonLabel:"Add Attachments",errorList:[],maxFileBytes:25e6,accept:[".docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document",".xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",".pdf","application/pdf",".jpg","image/jpg",".jpeg","image/jpg",".png","image/png",".gif","image/gif",".txt","text/plain"],$ctx:{...__vClientData},init(){Alpine.store("fileList",[]),this.$watch("$store.fileList",e=>{this.attachment.files=e,this.errorCheck()}),this.$watch("errorList",e=>this.attachment.errors=e)},acceptableFileTypes(){return this.accept&&this.accept.join(",")||""},get acceptableExtensions(){return!this.accept||!this.accept.length?[]:this.accept.filter(e=>e.startsWith(".")).map(e=>e.toLowerCase())},readableExtensionList(){let e=[...this.acceptableExtensions];return e.splice(-1,1,"or "+e[e.length-1]),e.join(", ")},tooManyBytes(){return this.totalFileBytes>this.maxFileBytes},get totalFileBytes(){return this.$store.fileList.reduce((e,i)=>e+=i.size,0)||0},sizeRemainingMessage(){return this.totalFileBytes?this.tooManyBytes()?`(${this.friendlySize(this.totalFileBytes-this.maxFileBytes)} too much!)`:`(${this.friendlySize(this.maxFileBytes-this.totalFileBytes)} left)`:`(${this.friendlySize(this.maxFileBytes)} max)`},checkType(e){if(!e)return;let i=e.type,s={img:[/image\/jpeg/,/image\/jpg/,/image\/png/,/image\/gif/],"file-pdf-o":[/application\/pdf/],"file-text-o":[/text\/plain/],"file-picture-o":[/image.*/],"file-sound-o":[/audio.*/],"file-movie-o":[/video.*/],"file-word-o":[/application\/msword/,/application.*wordprocessingml\.document/],"file-excel-o":[/application\/vnd\.ms-excel/,/application.*spreadsheetml\.sheet/]},t;for(let[n,a]of Object.entries(s))if(a.filter(l=>i.match(l)).length>0){t=n;break}return t==="img"&&this.loadThumbnail(e),t||"file-text-o"},friendlyExtension(e){return e.substring(e.lastIndexOf("."))},friendlySize(e,i){i=i||!0;let s=i?1e3:1024;if(Math.abs(e)<s)return e+" B";let t=i?["kB","MB","GB","TB","PB","EB","ZB","YB"]:["KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],n=-1;do e/=s,++n;while(Math.abs(e)>=s&&n<t.length-1);return`${e.toFixed(1)} ${t[n]}`},loadThumbnail(e){let i=this,s=new FileReader;s.onload=function(t){document.getElementById(e.name).src=t.target.result},s.readAsDataURL(e)},pickFiles(e){if(!e.length)return;let i=this.$store.fileList.map(s=>`${s.name}:${s.size}`);Array.from(Array(e.length).keys()).map(s=>{let t=e[s];i.includes(`${t.name}:${t.size}`)?console.log("skipping duplicate file:",t.name):this.isValidFileExtension(t)?this.$store.fileList.push(t):console.log("skipping invalid file extension",t.name)}),this.errorCheck()},removeFile(e){this.$store.fileList.splice(e,1),this.errorCheck()},isValidFileExtension(e){if(e.name.indexOf(".")<0)return!1;let i="."+e.name.split(".").pop().toLowerCase();return this.acceptableExtensions.includes(i)},errorCheck(){this.errorList=[],this.tooManyBytes()&&this.errorList.push(`The attached ${this.$store.fileList.length>1?"files are":"file is"} too large by ${this.friendlySize(this.totalFileBytes-this.maxFileBytes)}, please remove some files or send smaller ones.`)}}};})();
