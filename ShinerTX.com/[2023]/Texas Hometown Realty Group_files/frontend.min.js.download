var createCookie=function(a,b,c){if(c){var d=new Date;d.setTime(d.getTime()+c*60*1e3);var e="; expires="+d.toGMTString()}else{var e=""}document.cookie=a+"="+b+e+"; path=/"};jQuery(document).ready(function(a){var b=document.querySelectorAll('[name="widget_contact"]');var c='<input class="stop-validation trick-me" name="a_password" value="" required="" tabIndex="-1" autoComplete="off">';var d={root:null,rootMargin:"0px"};var e=new IntersectionObserver(function(b,d){b.forEach(function(b){if(!b.isIntersecting){a(b.target).find('[name="check_the_letters"]').after(c);return}else{setTimeout(function(){a('[name="a_password"]').remove()},15e3)}})},d);b.forEach(function(a){e.observe(a)});var f=function(a){a.find('input[type="text"], input[type="email"], input[type="phone"], textarea').val("")};var g=_placester.entitlementsHandler.shouldFireFbPixelLeadEvent();var h=_placester&&_placester.fbPixelConfig&&_placester.fbPixelConfig.fb_pixel_id?true:false;if(a.fn.validator){a('.pl_widget-contact form input[type="submit"]').on("mousedown",function(){var b=a(this).parents("form")[0];var c=a(b).find("input[required]:not(.stop-validation), textarea[required]").validator({messageClass:"form-validator-error",message:"<div><span></span></div>",position:"top center"});c.data("validator").checkValidity()})}a(".pl_widget-contact form").submit(function(b){var c=a(this).parent();var d=a(this).serialize();var e=a(this).data("uii");var i=a(this);b.preventDefault();if(a('[name="a_password"]').val()!==undefined){c.find(".error").show();return false}c.find(".error").hide();setTimeout(function(){a(".form-validator-error").hide()},5e3);if(a(".invalid",this).length){return false}c.find(".pl_widget-contact--formLoading").show();var j=a(this).children('input[name="custom_link"]').val();var k=a(this).children('input[name="custom_link_target"]').val();jQuery.ajax({type:"POST",url:info.ajaxurl,data:"action=placester_contact&"+d,dataType:"json",success:function(b){if(b.error===""){if(h&&g){try{fbq("track","Lead")}catch(j){console.warn("Error tracking Facebook Pixel event.")}}if(jQuery("body").hasClass("single-property")&&window.enableRecoloradoTrac&&recolorado_fflm){recolorado_fflm.TrackInquiry()}if(typeof _LT!=="undefined"&&_LT!==null&&window.enableListTrac&&jQuery("body").hasClass("single-property")){_LT._trackEvent(_eventType.lead,window.listTrac["listingId"],window.listTrac["postal"])}c.find(".pl_widget-contact--formLoading").fadeOut("fast");if(typeof pl_inject_conversion_snippet==="function")pl_inject_conversion_snippet();i.addClass("form_submitted");i.find('input[type="submit"]').val("Sent!");f(i);i.find(".form-validator-error").remove();i.slideUp();setTimeout(function(){c.find(".success").show("fast");i.find("input[name='form_submitted']").val(1);createCookie("pl_contact_cookie","true",.5)},500);pl_membership.setLeadCaptured();if(typeof _placester.uii==="object"&&b.lead_uuid){_placester.uii.addToPayLoad("lead_uuid",b.lead_uuid,true);_placester.uii.send({event:e,interaction_data:{action:"submit-success",result:b,element_data_type:"target",element_data:_placester.uii.getElementData(i.get(0))},form_data:_placester.uii.formSerializer(i.get(0))})}a(window).trigger("pl_leadCaptureSuccess");if(b.account_created&&b.account_url){setTimeout(function(){window.location.href=window.location.href},3e3)}else if(b.redirect){var d=typeof getTemplateName==="function"?getTemplateName():"";if(d==="Highland"){setTimeout(function(){window.location.href=b.redirect},3e3)}else{window.open(b.redirect,b.redirect_target)}}}else{c.find(".pl_widget-contact--formLoading").hide();c.find(".error").html(b.error).show("fast");if(typeof _placester.uii==="object"){_placester.uii.send({event:e,interaction_data:{action:"submit-error",result:b,element_data_type:"target",element_data:_placester.uii.getElementData(i.get(0))},form_data:_placester.uii.formSerializer(i.get(0))})}}}})})});var createCookie=function(a,b,c){if(c){var d=new Date;d.setTime(d.getTime()+c*60*1e3);var e="; expires="+d.toGMTString()}else{var e=""}document.cookie=a+"="+b+e+"; path=/"};jQuery(document).ready(function(a){setTimeout(function(){a('[name="a_password"]').remove()},1e4);var b=function(a){a.find('input[type="text"], input[type="email"], input[type="phone"], textarea').val("")};var c=_placester.entitlementsHandler.shouldFireFbPixelLeadEvent();var d=_placester&&_placester.fbPixelConfig&&_placester.fbPixelConfig.fb_pixel_id?true:false;if(a.fn.validator){a('.custom-form form input[type="submit"]').on("mousedown",function(b){var c=a(a(b.target).parents("form")[0]);var d="form-validator-error";c.find(".checkbox-group[data-required=required]").each(function(b,c){c=a(c);var e=c.find("input[type=checkbox]:first");if(!c.has("input[type=checkbox]:checked").length){var f=c.position();a('<div><span></span><p style="display: inline"></p></div>').addClass(d).css({position:"absolute",left:f.left-65+"px",top:f.top+"px"}).appendTo(document.body).find("p").text("Please select an option.");e.addClass("invalid")}else{e.removeClass("invalid")}});var e=c.find("input[required]:not(.stop-validation), textarea[required]").validator({messageClass:d,message:"<div><span></span></div>",position:"top center"});e.data("validator").checkValidity()})}a(".custom-form form").submit(function(e){var f=a(this).parent();var g=a(this).serialize();var h=a(this).data("uii");var i=a(this);e.preventDefault();if(a('[name="a_password"]').val()!==undefined){f.find(".error").show();return false}f.find(".error").hide();setTimeout(function(){a(".form-validator-error").hide()},5e3);if(a(".invalid",this).length){return false}f.find(".custom-landing--formLoading").show();jQuery.ajax({type:"POST",url:info.ajaxurl,data:"action=placester_custom_contact&is_lead=true&"+g,dataType:"json",success:function(e){if(e.error===""){if(d&&c){try{fbq("track","Lead")}catch(g){console.warn("Error tracking Facebook Pixel event.")}}f.find(".custom-landing--formLoading").fadeOut("fast");if(typeof pl_inject_conversion_snippet==="function")pl_inject_conversion_snippet();i.addClass("form_submitted");i.find('input[type="submit"]').val("Sent!");b(i);i.find(".form-validator-error").remove();i.slideUp();setTimeout(function(){a(".sub-title").hide();f.find(".success").show("fast");i.find("input[name='form_submitted']").val(1);createCookie("pl_contact_cookie","true",.5)},500);pl_membership.setLeadCaptured();if(typeof _placester.uii==="object"&&e.lead_uuid){_placester.uii.addToPayLoad("lead_uuid",e.lead_uuid,true);_placester.uii.send({event:h,interaction_data:{action:"submit-success",result:e,element_data_type:"target",element_data:_placester.uii.getElementData(i.get(0))},form_data:_placester.uii.formSerializer(i.get(0))})}if(e.account_created&&e.account_url){setTimeout(function(){window.location.href=e.account_url},3e3)}else if(e.redirect){window.open(e.redirect,e.redirect_target)}}else{f.find(".custom-landing--formLoading").hide();f.find(".error").html(e.error).show("fast");if(typeof _placester.uii==="object"){_placester.uii.send({event:h,interaction_data:{action:"submit-error",result:e,element_data_type:"target",element_data:_placester.uii.getElementData(i.get(0))},form_data:_placester.uii.formSerializer(i.get(0))})}}}})})});window._placester=window._placester||{};window._placester.entitlementsHandler=function(){var a;function b(){var a=window._placester&&window._placester.entitlements?window._placester.entitlements:null;var b=window._placester&&window._placester.site_disabled?window._placester.site_disabled:false;function c(b){var c=false;if(b&&a&&a[b]){c=true}return c}function d(){var a=document.cookie.match("(^|;) ?"+"preview_site"+"=([^;]*)(;|$)");cookie=a?a[2]:null;if(b&&!cookie||b&&cookie!=="enabled"){return true}}return{shouldShowTestimonials:function(){return c("sites:testimonials")},shouldShowMapSearch:function(){if(d()){return false}return c("map_search")},shouldShowStandardMaps:function(){if(d()){return false}return c("sites:widgets:maps")},shouldShowLoginRegister:function(){return c("sites:users:login")},shouldShowFeaturedListings:function(){return c("sites:featlistings")},shouldShowHomepageBlogs:function(){return c("sites:posts")},shouldShowSavedSearch:function(){return c("sites:savedsearch")},shouldShowFavListingLink:function(){return c("sites:favlistings")},shouldFireFbPixelLeadEvent:function(){return c("sites:fbpixel:event:lead")},shouldShowColorImages:function(){return c("sites:color_images")},shouldShowLogo:function(){return c("sites:logo")},shouldHideFreeAd:function(){return c("sites:no_ad")}}}return{getInstance:function(){if(!a){a=b()}return a}}}().getInstance();function Filters(){}Filters.prototype.init=function(a){this.filters={};this.dom_id=a.dom_id||false;this.list=a.list||false;this.map=a.map||false;this.listings=a.listings||false;this.custom_update_callback=a.custom_update_callback||false;this.cssSelector=a["class"]||".pls_search_form_listings";this.form=jQuery(this.cssSelector).get(0);var b=this.cssSelector+", #sort_by, #sort_dir";var c=this;this.listener={elements:[],events:"change submit"};if(a.listener){b=a.listener.elements||b;jQuery.extend(this.listener,a.listener)}jQuery(b).each(function(){if(jQuery(this).is(":input"))c.listener.elements.push(this);else{c.listener.elements=c.listener.elements.concat(jQuery(this).not("div.container-chosen").find(":input").get())}})};Filters.prototype.listeners=function(a){var b=this;jQuery(this.listener.elements).on(this.listener.events,function(a){a.preventDefault();var c=this==jQuery(b.cssSelector)[0];b.listings.get(c)})};Filters.prototype.get_values=function(){var a=[];jQuery.each(jQuery(this.listener.elements).serializeArray(),function(b,c){a.push({name:c.name,value:c.value})});return a};Filters.prototype.set_values=function(a){var b=this;jQuery.post(info.ajaxurl,{action:"get_permalink_search_filters",search_id:a},function(a,c,d){jQuery(b.listener.elements).each(function(b){if(this.name=="purchase_types[]"){if(a["purchase_types[0]"]){jQuery(this).val(a["purchase_types[0]"]);jQuery(this).trigger("chosen:updated")}}else if(this.name=="zoning_types[]"){if(a["zoning_types[0]"]){jQuery(this).val(a["zoning_types[0]"]);jQuery(this).trigger("chosen:updated")}}else if(a[this.name]){jQuery(this).val(a[this.name]);jQuery(this).trigger("chosen:updated")}});if(b.map){var e=[];for(var f in a){if(f.indexOf("polygon[")>-1){e.push(a[f])}}if(e.length)b.map.center(e)}if(typeof b.custom_update_callback=="function"){b.custom_update_callback(a)}if(typeof pl_SearchLoadCallback==="function")pl_SearchLoadCallback(b.cssSelector,a);if(b.listings&&!jQuery.isEmptyObject(a)){if(a.hasOwnProperty("limit")){a.iDisplayLength=parseInt(a.limit);delete a.limit}if(a.hasOwnProperty("offset")){a.iDisplayStart=a.offset;delete a.offset}b.listings.fetched_saved_search(a)}},"json")};jQuery(function(){if(!Modernizr.input.placeholder){var a=function(){function a(a){a.value===a.getAttribute("placeholder")&&(a.className=a.className.replace(/\bplaceholderspolyfill\b/,""),a.value="")}function b(a){""===a.value&&(a.className+=" placeholderspolyfill",a.value=a.getAttribute("placeholder"))}function c(c){c.addEventListener?(c.addEventListener("focus",function(){a(c)},!1),c.addEventListener("blur",function(){b(c)},!1)):c.attachEvent&&(c.attachEvent("onfocus",function(){a(c)}),c.attachEvent("onblur",function(){b(c)}))}function d(){var a=document.getElementsByTagName("input"),b=document.getElementsByTagName("textarea"),d=a.length,e=d+b.length,f,h,i,j;for(f=0;f<e;f+=1)if(h=f<d?a[f]:b[f-d],j=h.getAttribute("placeholder"),-1===g.indexOf(h.type)&&j&&(i=h.getAttribute("data-currentplaceholder"),j!==i)){if(h.value===i||h.value===j||!h.value)h.value=j,h.className+=" placeholderspolyfill";i||c(h);h.setAttribute("data-currentplaceholder",j)}}function e(a){return function(){var b=a.getElementsByTagName("input"),c=a.getElementsByTagName("textarea"),d=b.length,e=d+c.length,f,g,h;for(h=0;h<e;h+=1)f=h<d?b[h]:c[h-d],g=f.getAttribute("placeholder"),f.value===g&&(f.value="")}}function f(){var a=document.getElementsByTagName("input"),b=document.getElementsByTagName("textarea"),d=a.length,f=d+b.length,h,i,j;for(h=0;h<f;h+=1)if(i=h<d?a[h]:b[h-d],j=i.getAttribute("placeholder"),-1===g.indexOf(i.type)&&j){i.setAttribute("data-currentplaceholder",j);if(""===i.value||i.value===j)i.className+=" placeholderspolyfill",i.value=j;i.form&&(j=i.form,j.getAttribute("data-placeholdersubmit")||(j.addEventListener?j.addEventListener("submit",e(j),!1):j.attachEvent&&j.attachEvent("onsubmit",e(j)),j.setAttribute("data-placeholdersubmit","true")));c(i)}}var g="hidden datetime date month week time datetime-local range color checkbox radio file submit image reset button".split(" ");return{init:function(a){var b,c,e,g;"undefined"===typeof document.createElement("input").placeholder&&(b=document.createElement("style"),b.type="text/css",c=document.createTextNode(".placeholderspolyfill { color:#999 !important; }"),b.styleSheet?b.styleSheet.cssText=c.nodeValue:b.appendChild(c),document.getElementsByTagName("head")[0].appendChild(b),Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){e=b||0;for(g=this.length;e<g;e+=1)if(this[e]===a)return e;return-1}),f(),a&&setInterval(d,100));return!1},refresh:d}}();a.init(true)}});function pl_SearchLoadCallback(a,b){pl_SetPriceSelectors(a,b,true)}function pl_SetPriceSelectors(a,b,c){var d=jQuery(a);var e=d.find(".pl_form-purchase_types option:selected").val();var f=d.find(".pl_form-min_price").find("select");var g=d.find(".pl_form-max_price").find("select");if(typeof e!=="undefined"){var h=priceAll;f.empty();g.empty();f.append(jQuery("<option></option>").attr("value","").text("Min Price"));g.append(jQuery("<option></option>").attr("value","").text("Max Price"));if(e=="rental"){h=priceRental}else if(e=="sale"){h=priceSale}jQuery.each(h,function(a,b){f.append(jQuery("<option></option>").attr("value",a).text(b));g.append(jQuery("<option></option>").attr("value",a).text(b))})}if(typeof b!=="undefined"){d.find(".pl_form-min_price,.pl_form-max_price").find("option:first-child").attr("selected","selected");if(b["metadata[min_price]"]){d.find('select[name="metadata[min_price]"]').val(b["metadata[min_price]"])}if(b["metadata[max_price]"]){d.find('select[name="metadata[max_price]"]').val(b["metadata[max_price]"])}}f.trigger("chosen:updated");g.trigger("chosen:updated")}(function(a){window.PL_UTIL={formatDecimal:function(a){var b=[],c,d,e,f,g;a=a.toString().trim();c=a.split(".");d=c[0];while(d.length>3){b.unshift(d.slice(-3));d=d.slice(0,d.length-3)}g=typeof c[1]==="undefined"?"":"."+c[1];e=b.length>0?",":"";f=d?d+e:"";return f+b.join(",")+g},formatCurrency:function(a,b){if(typeof b==="undefined"){b="$"}return b+=this.formatDecimal(a)}};var b={init:function(){if(b.isSPSHome()){b.openHouseDates()}},openHouseDates:function(){$showMoreLink=a("#toggle-oh-dates");if($showMoreLink.length){$showMoreLink.click(function(b){b.preventDefault();a(".oh-dates").toggle("slow");newText=$showMoreLink.data("toggle-text");$showMoreLink.data("toggle-text",$showMoreLink.html());$showMoreLink.text(newText)})}},isSPSHome:function(){return a("body.sps.single-property").length}};jQuery(document).ready(function(a){b.init()})})(jQuery);jQuery(document).ready(function(a){if(typeof a.fn.dataTable==="undefined"){return}if(a("#placester_fav_list").length){var b=[];var c={sEmptyTable:"You haven't saved any listings yet.",sZeroRecords:""};var d=a("#favorite-listings");if(d.length&&d.data("use-custom")===true){c.sLengthMenu="<span id='dataTables_length_show'>Showing</span> _MENU_"}var e=a("#placester_fav_list").dataTable({bFilter:false,bProcessing:true,bServerSide:true,sPaginationType:"full_numbers",sServerMethod:"POST",sAjaxSource:info.ajaxurl,aLengthMenu:[[10,20,50],[10,20,50]],oLanguage:c,fnDrawCallback:function(){if(jQuery("#placester_fav_list_paginate span a").length<=1){jQuery("#placester_fav_list_paginate").hide()}if(jQuery("#placester_fav_list tbody").length>1){jQuery(".compliance-inline").show()}},fnRowCallback:function(a,b,c,e){if(d.length){jQuery(a).addClass(d.data("grid-item"))}},fnServerData:function(c,d,e){d.push({name:"action",value:"pl_fav_listings"});d=f(d);a.ajax({dataType:"json",type:"POST",url:c,data:d,success:function(a){if(a&&a["aaData"]){for(var c in b){b[c].setMap(null)}if(typeof window["google"]!="undefined"&&typeof pls_google_map!="undefined"){b=[];var d=new google.maps.LatLngBounds;for(var f in a["aaData"]){var g=a["aaData"][f][1];marker=new google.maps.Marker({position:new google.maps.LatLng(g["location"]["coords"][0],g["location"]["coords"][1]),map:pls_google_map});marker.setMap(pls_google_map);d.extend(marker.getPosition());b.push(marker)}pls_google_map.fitBounds(d)}}e(a);if(window.hookup_favoriting){window.hookup_favoriting()}}})}});window.my_fav_datatable=e;a(".sort_wrapper select").on("change",function(a){a.preventDefault();e._fnAjaxUpdate()});a("body").on("click","#placester_fav_list_wrapper .paginate_button",function(){a("html,body").animate({scrollTop:a("#placester_fav_list_wrapper").offset().top-70},1e3)})}function f(b){b.push({name:"sort_by",value:a(".sort_wrapper select[name=sort_by]").val()},{name:"sort_type",value:a(".sort_wrapper select[name=sort_type]").val()},{name:"context",value:a("#context").attr("class")},{name:"listing_template",value:a("#listing_template").attr("class")});return b}});function List(){}List.prototype.sEcho=1;List.prototype.init=function(a){var b=this;this.loading_class=a.loading_class||".dataTables_processing";this.dom_id=a.dom_id||"#placester_listings_list";this.sort_wrapper=a.sort_wrapper||".sort_wrapper";this.sort_by=a.sort_by||false;this.sort_type=a.sort_type||false;this.limit_dropdown_class=a.limit_dropdown_class||".dataTables_length";this.pagination_id=a.pagination_id||this.dom_id+"_paginate";this.custom_search_results_id=this.custom_search_results_id||"#pls_listings_search_results";this.className=a["class"]||false;this.table_row_selector=a.table_class||".placester_properties tr";this.context=a.context||false;this.listing_template=a.listing_template||false;this.grid_item=a.grid_item||false;this.total_results_id=a.total_results_id||"#pls_num_results";this.limit_default=a.limit_default||10;this.limit_choices=a.limit_choices||[[10,20,50],[10,20,50]];this.settings=a.settings||{bFilter:false,bProcessing:true,bServerSide:true,sServerMethod:"POST",sPaginationType:"full_numbers",sAjaxSource:info.ajaxurl,iDisplayLength:this.limit_default,aLengthMenu:this.limit_choices,oLanguage:a.custom_text||{},fnRowCallback:function(b,c,d,e){if(this.grid_item||a.grid_item){var f=this.grid_item||a.grid_item;jQuery(b).addClass(f)}if((d+1)%3==0){jQuery(b).addClass("third")}}};this.results_as_total=0;this.fnCallback=a.fnCallback||false;this.manual_callback=a.manual_callback||false;this.listings=a.listings||alert("List: You need to include a listings object");this.map=a.map||false;this.hide_on_empty=a.hide_on_empty||false;this.empty_id=a.empty_id||false;this.settings.fnServerData=function(c,d,e){if(a.get_listings){a.get_listings(b,c,d,e)}else{b.get_listings(b,c,d,e)}};jQuery("body").on("click",this.dom_id+"_wrapper .paginate_button",function(){jQuery("html,body").animate({scrollTop:jQuery(b.dom_id+"_wrapper").offset().top-70},1e3)})};List.prototype.get_listings=function(a,b,c,d){var e=a;e.show_loading();e.fnCallback=d;e.listings.get()};List.prototype.update=function(a){this.total_results(a);if(this.fnCallback){this.fnCallback(a)}this.update_favorites_through_cache();if(a.iDisplayStart&&a.iDisplayLength){var b=this.datatable.fnSettings()._iDisplayStart;var c=Number(a.iDisplayStart);if(c!==b){var d=Number(a.iDisplayLength);var e=Math.round(c/d);this.datatable.fnPageChange(e,false);jQuery.fn.dataTableExt.oPagination.full_numbers.fnUpdate(this.datatable.fnSettings())}}this.hide_loading();if(a.aaData.length>0){this.hide_empty();if(window.hookup_favoriting){hookup_favoriting()}if(typeof _placester.uii==="object"){_placester.uii.element(jQuery(this.dom_id).get(0))}}else{this.show_empty()}};List.prototype.total_results=function(a){var b=a.iTotalRecords;var c=a.iTotalDisplayRecords;if(b>c)this.results_as_total=c+"+";else this.results_as_total=c;jQuery(this.total_results_id).html(this.results_as_total);jQuery(this.total_results_id).parent().removeClass("is-hidden")};List.prototype.update_favorites_through_cache=function(){jQuery.post(info.ajaxurl,{action:"get_favorite_ids"},function(a,b,c){if(a){jQuery(".pl_add_remove_lead_favorites .pl_prop_fav_link").each(function(b){var c=false;for(var d=a.length-1;d>=0;d--){if(jQuery(this).attr("href")=="#"+a[d]){if(jQuery(this).hasClass("pl_add_favorite")){jQuery(this).hide()}else{jQuery(this).show()}c=true;break}}if(!c){if(jQuery(this).hasClass("pl_add_favorite")){jQuery(this).show()}else{jQuery(this).hide()}}})}},"json")};List.prototype.row_mouseover=function(a){jQuery(this.table_row_selector).find("[data-listing="+a+"]").trigger("mouseenter")};List.prototype.row_mouseleave=function(a){jQuery(this.table_row_selector).find("[data-listing="+a+"]").trigger("mouseleave")};List.prototype.listeners=function(){var a=this;if(this.map){jQuery(this.table_row_selector).on({mouseenter:function(){jQuery(this).addClass("hover");a.map.marker_mouseover(jQuery(this).children().children().attr("data-listing"))},mouseleave:function(){jQuery(this).removeClass("hover");a.map.marker_mouseout(jQuery(this).children().children().attr("data-listing"))}})}};List.prototype.show_loading=function(){jQuery(this.loading_class).css("visibility","visible")};List.prototype.hide_loading=function(){jQuery(this.loading_class).css("visibility","hidden")};List.prototype.show_empty=function(){if(this.hide_on_empty){jQuery(this.dom_id).hide();jQuery(this.sort_wrapper).hide();jQuery(this.limit_dropdown_class).hide();jQuery(this.pagination_id).hide();jQuery(this.custom_search_results_id).hide()}if(this.empty_id)jQuery(this.empty_id).show()};List.prototype.hide_empty=function(){if(this.hide_on_empty){jQuery(this.dom_id).show();jQuery(this.sort_wrapper).show();jQuery(this.limit_dropdown_class).show();jQuery(this.pagination_id).show();jQuery(this.custom_search_results_id).show()}if(this.empty_id)jQuery(this.empty_id).hide()};function Listings(a){this.map=a.map||false;this.list=a.list||false;this.filter=a.filter||false;this.poi=a.poi||false;this.hook=a.hook||"pl_listings_ajax";this.sSource=a.sSource||info.ajaxurl;this.aoData=a.aoData||[];this.active_filters=[];this.previous_filters=[];this.single_listing=a.single_listing||false;this.property_ids=a.property_ids||false;this.default_filters=a.default_filters||[];this.filter_override=a.filter_override||false;this.is_new_serch=false;this.from_back_button=false;this.search_hash=false;this.sort_by=a.list?a.list.sort_by:false;this.sort_type=a.list?a.list.sort_type:false;this.disable_saved_search=a.disable_saved_search||false;this.initial_load=true;this.pending=false;this.query_only=false}Listings.prototype.init=function(){var a=this;if(this.filter){this.filter.listeners(function(){a.update()})}if(this.map){this.map.listeners()}if(this.list){this.list.listeners();jQuery.address.change(function(b){if(!a.is_new_serch){a.from_back_button=true;a.get()}});this.list.datatable=jQuery(this.list.dom_id).dataTable(this.list.settings)}if(this.single_listing){this.get()}};Listings.prototype.get=function(a,b){this.is_new_serch=true;var c=this;if(this.pending){return}var d=a||false;this.query_only=b||false;if(!this.query_only){if(d){this.list.datatable.fnPageChange(0,false)}if(this.map.type=="single_listing"){google.maps.event.addDomListenerOnce(window,"load",function(){c.map.update({aaData:[["",c.single_listing]],iDisplayLength:0,iDisplayStart:0,sEcho:0})});return false}if(this.map.type=="neighborhood"&&!this.map.selected_polygon&&!this.map.neighborhood.neighborhood_override){if(this.list)this.list.update({aaData:[],iDisplayLength:0,iDisplayStart:0,sEcho:this.list.sEcho});if(this.map)this.map.update({aaData:[],iDisplayLength:0,iDisplayStart:0,sEcho:this.list.sEcho});return false}}this.pending=true;if(this.default_filters.length>0){this.active_filters=this.default_filters}if(this.property_ids){this.active_filters.push({name:"property_ids",value:this.property_ids})}if(this.list&&this.list.datatable){if(!this.query_only)this.list.show_loading();var e=this.list.datatable.fnSettings();this.active_filters.push({name:"iDisplayLength",value:e._iDisplayLength});this.active_filters.push({name:"iDisplayStart",value:e._iDisplayStart});this.list.sEcho++;this.active_filters.push({name:"sEcho",value:this.list.sEcho})}else if(this.list){if(!this.query_only)this.list.show_loading();this.active_filters.push({name:"iDisplayLength",value:this.list.limit_default});this.active_filters.push({name:"iDisplayStart",value:0});this.active_filters.push({name:"sEcho",value:1})}if(this.list&&this.list.context){this.active_filters.push({name:"context",value:this.list.context})}if(this.list&&this.list.listing_template){this.active_filters.push({name:"listing_template",value:this.list.listing_template})}if(this.list&&this.list.grid_item){this.active_filters.push({name:"grid_item",value:this.list.grid_item})}if(this.filter){this.active_filters=this.active_filters.concat(this.filter.get_values())}if(this.list.sort_by){this.active_filters.push({name:"sort_by",value:this.list.sort_by})}if(this.list.sort_type){this.active_filters.push({name:"sort_type",value:this.list.sort_type})}if(this.filter_override){for(var f=this.filter_override.length-1;f>=0;f--){this.active_filters.push(this.filter_override[f])}}this.active_filters.push({name:"action",value:this.hook});this.active_filters=this.check_multiple_search_filters(this.active_filters);var g=false;if(this.map&&(this.map.type=="neighborhood"||this.map.filter_by_bounds)){if(!this.query_only)this.map.show_loading();if(this.map.filter_by_bounds){if(this.initial_load){g=true}else{for(var f=0;f<this.active_filters.length;f++){if(this.active_filters[f].name.indexOf("location[")>-1&&this.previous_filters.some(function(a){return a.name===c.active_filters[f].name&&a.value!==c.active_filters[f].value})){g=true;break}}if(!g)this.active_filters=this.active_filters.concat(this.map.get_bounds())}}}if(!this.query_only&&this.disable_saved_search===false){var h=this.generate_search_hash();var i=jQuery.address.value();if(window.location.href.indexOf("post_type=pl_general_widget")==-1&&window.location.href.indexOf("post.php?post=")==-1&&window.location.href.indexOf("/pl_general_widget/")==-1){if(i!=="/"&&(this.search_hash===h||this.search_hash===false||this.from_back_button)){this.active_filters.push({name:"saved_search_lookup",value:i});this.search_hash=i;if(this.filter){this.filter.set_values(i)}}else{this.active_filters.push({name:"saved_search_lookup",value:"/"+h});jQuery.address.value(h);this.search_hash="/"+h}}}this.search_event(this.active_filters);jQuery.ajax({dataType:"json",type:"POST",url:this.sSource,data:c.active_filters,success:function(a){c.is_new_serch=false;c.from_back_button=false;c.ajax_response=a;if(c.query_only){if(c.map){c.map.data_available(a)}c.pending=false}else{if(c.map){c.map.update(a,g)}if(c.list){c.list.update(a)}if(c.poi)c.poi.update();if(c.list.manual_callback)c.list.manual_callback();c.previous_filters=c.active_filters.slice(0);c.active_filters=[];c.pending=false;c.initial_load=false}},error:function(a){console.log("failed to fetch data");if(c.map)c.map.hide_loading();if(c.list)c.list.hide_loading();c.pending=false}})};Listings.prototype.fetched_saved_search=function(a){this.search_event(a)};Listings.prototype.search_event=function(a){var b=this;setTimeout(function(){if(typeof _placester.uii==="object"){var c=b.filter&&b.filter.form?b.filter.form.getAttribute("data-uii"):"";var d={};var e=_placester.uii.generateUUID();if(jQuery.isArray(a)){var f=a.length;for(var g=0;g<f;g++){d[a[g].name]=a[g].value}}else{d=a}for(var h in d){var i=h.indexOf("[");if(i>0){var j=h.substring(0,i);var k=h.substring(i+1,h.length-1);d[j]=d[j]||{};d[j][k]=d[h];delete d[h]}}_placester.uii.addToPayLoad("searchId",e,false);_placester.uii.send({event:c||"form:search",interaction_data:{action:"submit",element_data_type:"target",element_data:{name:"search"}},form_data:d,status:b.initial_load?"passive":"active"})}else{b.search_event(a)}},100)};Listings.prototype.generate_search_hash=function(){var a="";for(var b=this.active_filters.length-1;b>=0;b--){if(this.active_filters[b]){if(this.active_filters[b]["name"]=="saved_search_lookup"||this.active_filters[b]["name"]=="sEcho")continue;a+=this.active_filters[b]["name"];a+=this.active_filters[b]["value"]}}return this.fast_hasher(a)};Listings.prototype.fast_hasher=function(a){var b=0;if(a.length==0)return b;for(i=0;i<a.length;i++){char=a.charCodeAt(i);b=(b<<5)-b+char;b=b&b}return b};Listings.prototype.get_search_count=function(){var a=this;a.check_search_form_count();jQuery(".pls_search_results_num_form select, .pls_search_results_num_form input[type='text'], .pls_search_results_num_form input[type='hidden']").on("change",function(b){a.check_search_form_count()})};Listings.prototype.check_search_form_count=function(){jQuery("#pls_num_results_found").before("<div id='pls_search_count_spinner'></div>");var a=jQuery(".pls_search_results_num_form").serializeArray();var b={};a=this.check_multiple_search_filters(a);var c=new Array("location[locality][]","location[neighborhood][]","location[region][]","location[postal][]");for(var d=a.length-1;d>=0;d--){if(b[a[d].name]&&c.indexOf(a[d].name)!=-1){var e=b[a[d].name];if(e instanceof Array){b[a[d].name].push(a[d].value)}else{b[a[d].name]=new Array(e,a[d].value)}}else{b[a[d].name]=a[d].value}}b.action="pl_get_search_count";b.iDisplayLength=1;jQuery.ajax({dataType:"json",type:"POST",data:b,url:info.ajaxurl,success:function(a){if(a){jQuery("#pls_num_results_found").html(a.count);jQuery("#pls_num_results_found").hide();jQuery("#pls_num_results_found").get(0).offsetHeight;jQuery("#pls_num_results_found").show();jQuery("#pls_search_count_spinner").remove()}}},"json")};Listings.prototype.check_multiple_search_filters=function(a){var b=new Array("location[locality]","location[neighborhood]","location[region]","location[postal]","property_type","metadata[condo_name]","rets[oid]");for(var c=b.length-1;c>=0;c--){var d=new Array;for(var e=a.length-1;e>=0;e--){filter=a[e];if(filter.name.slice(0,-2)==b[c]){d.push(filter.value);delete filter}}if(d.length>1){if(b[c].slice(-1)=="]"){multiFilterMatch=b[c].slice(0,-1)+"_match]"}else{multiFilterMatch=b[c]+"_match"}a.push({name:multiFilterMatch,value:"in"})}}return a};window.redirectFromNonDismissableLeadCapture=false;window.redirectFromNonDismissableSignIn=false;var pl_membership={logged_in:false,deferred_action:{},init:function(){$=jQuery;var a=this;a.logged_in=$("body").hasClass("logged-in");if(typeof $.fancybox=="function"){a.registerListeners();if($("#pl_loginMakePassword").length){a.showPasswordResetForm()}if($("#pl_leadCapture").length&&!a.isLeadCaptured()&&!a.logged_in){var b=window.pl_lc_page_type?window.pl_lc_page_type:false;if(window.pl_lc_owner_hide&&window.pl_lc_owner_hide.hide){var c=a.checkShowLeadCapture(b);var d=$.ajax({url:window.pl_lc_owner_hide.auth_url,type:"GET",dataType:"json",xhrFields:{withCredentials:true}});$.when(c,d).done(function(b,c){if(c[1]==="success"&&c[0]&&c[0].account_id&&c[0].account_id==window.pl_lc_owner_hide.account_id){return false}a.processShowLeadCapture(b[0],b[1])})}else{var c=a.checkShowLeadCapture(b);$.when(c).done(function(b,c){a.processShowLeadCapture(b,c)})}}if(a.logged_in){var e=$.cookies.get("deferred_action")||{};if(e.action){a.handleDeferredAction(e)}}$.cookies.set("deferred_action",a.deferred_action)}$(".pl_add_remove_lead_favorites").show()},registerListeners:function(){var a=this;$(".pl_register_lead_link").click(function(b){b.preventDefault();document.getElementById("auto_form_type").value="form:registration";a.showSignupForm()});$(".pl_login_link").click(function(b){b.preventDefault();if(b.currentTarget.dataset.source!=undefined&b.currentTarget.dataset.source==="lead_capture"){if(typeof pl_lc_force_back==="undefined"||pl_lc_force_back==1){
window.redirectFromNonDismissableLeadCapture=true}}a.showLoginForm()});$(".pl_form--switchForms").click(function(b){b.preventDefault();if(b.currentTarget.dataset.source!=undefined&b.currentTarget.dataset.source==="sign_in"){if(typeof pl_lc_force_back==="undefined"||pl_lc_force_back==1){window.redirectFromNonDismissableSignIn=true}}a.setupFormSwitchLink()});$(".pl_logout_link").click(function(a){if(typeof _placester.uii==="object")_placester.uii.addToPayLoad("lead_uuid","",true)});$("#pl_confirmationResend").click(function(b){b.preventDefault();a.sendConfirmationEmail()});$(".js-pl_membershipForm").on("mousedown",'input[type="submit"]',function(){a.validateForm(this)});$(".js-pl_membershipForm").keypress(function(b){var c=b.keyCode||b.which;if(c==13){a.validateForm(this)}});$(".js-pl_membershipForm").submit(function(b){b.preventDefault();if(a.validateForm(this)){a.submitForm(this)}});$(document).on("click",".pl_prop_fav_link.pl_add_favorite",function(b){b.preventDefault();property_id=$(this).attr("href");var c={action:"add_favorite_property",property_id:property_id.substr(1)};if(!a.logged_in){document.getElementById("auto_form_type").value="form:registration_favorite_listing";var d={deferred_action:{context:"pl_membership",fn:"addFavorite"},params:c};a.showSignupForm(d)}else{a.addFavorite(c)}});$(document).on("click",".pl_prop_fav_link.pl_remove_favorite",function(a){a.preventDefault();var b=this;var c=$(this).parent().find(".pl_spinner");c.show();property_id=$(this).attr("href");data={action:"remove_favorite_property",property_id:property_id.substr(1)};$.post(info.ajaxurl,data,function(a){c.hide();if(a!="errors"){$(b).hide();$(b).parent().find(".pl_add_favorite").show()}},"json")});$(document).ajaxStop(function(){if(a.logged_in||typeof $.fancybox=="function"&&$(".pl_leadRegister").length){$(".pl_add_remove_lead_favorites").show()}})},setupFormSwitchLink:function(){if(!(typeof getTemplateName==="function"&&getTemplateName()==="Highland")){var a=this;$(".pl_form--switchForms").fancybox({fitToView:false,autoSize:true,maxWidth:"85%",padding:0,scrolling:"no",wrapCSS:"pl_fbox",beforeClose:function(){if(window.redirectFromNonDismissableSignIn&&window.redirectFromNonDismissableLeadCapture){if(typeof pl_lc_force_back==="undefined"||pl_lc_force_back==1){a.resetForm(this);window.location=typeof pl_lc_redirect!=="undefined"?pl_lc_redirect:"/";return false}}else{a.resetForm(this)}}})}},loggedIn:function(){return this.logged_in},showPasswordResetForm:function(){if(typeof getTemplateName==="function"&&getTemplateName()==="Highland"){$(window).trigger("pl_openPasswordResetForm")}else{var a=this;setTimeout(function(){$.fancybox.open("#pl_loginMakePassword",{fitToView:false,autoSize:true,maxWidth:"85%",padding:0,scrolling:"no",wrapCSS:"pl_fbox",beforeClose:function(){if(window.redirectFromNonDismissableSignIn){if(typeof pl_lc_force_back==="undefined"||pl_lc_force_back==1){a.resetForm(this);window.location=typeof pl_lc_redirect!=="undefined"?pl_lc_redirect:"/";return false}}else{a.resetForm(this)}},afterClose:function(){var a=$(this.content).find("input[name=redirect_to]").val();if(a){window.location=a}}})})}},showSignupForm:function(a){var b=this;if(typeof getTemplateName==="function"&&getTemplateName()==="Highland"){a=a||{};b.deferred_action.action=a.deferred_action||{};b.deferred_action.args=a.params;$(window).trigger("pl_openSignUpForm")}else{if($("#pl_leadRegister").length){a=a||{};b.deferred_action.action=a.deferred_action||{};b.deferred_action.args=a.params;b.openForm("#pl_leadRegister")}}},showLoginForm:function(){if(typeof getTemplateName==="function"&&getTemplateName()==="Highland"){$(window).trigger("pl_openLoginForm")}else{var a=this;a.deferred_action={};a.showLoginFormFancyBox("#pl_login",null)}},showLoginFormFancyBox:function(a,b){var c=this;b=b||null;$.fancybox(a,{fitToView:false,autoSize:true,maxWidth:"85%",padding:0,scrolling:"no",wrapCSS:"pl_fbox",beforeClose:function(){if(window.redirectFromNonDismissableSignIn){c.resetForm(this)}else{if(window.redirectFromNonDismissableLeadCapture){if(typeof pl_lc_force_back==="undefined"||pl_lc_force_back==1){c.resetForm(this);window.location=typeof pl_lc_redirect!=="undefined"?pl_lc_redirect:"/";return false}else{c.resetForm(this)}}else{c.resetForm(this)}}},afterClose:b})},openForm:function(a,b){var c=this;b=b||null;$.fancybox(a,{fitToView:false,autoSize:true,maxWidth:"85%",padding:0,scrolling:"no",wrapCSS:"pl_fbox",beforeClose:function(){c.resetForm(this)},afterClose:b})},resetForm:function(a){var b=a.content||$(".fancybox-inner");b.parent().find("form").each(function(){this.reset();$(this).find(".error, .success").hide()})},validateForm:function(a){var b=$(a).closest("form");b.find(".error").html("").hide();if(jQuery().validator){var c=b.validator({messageClass:"form-validator-error",message:"<div><span></span></div>",position:"top center"});return c.data("validator").checkValidity()}else{return true}},handleFormErrors:function(a,b){var c=b&&b.errors?b.errors:{};if(c.message){a.find(".error").append(c.message).show()}if(c.fields){if(jQuery().validator){a.data("validator").invalidate(c.fields)}}},submitForm:function(a){var b=this;var c=$(a).closest("form");var d=$(a).find(".js-form-content");var e=c.find('input[name="action"]').val();var f=c.find('input[type="submit"]');var g=f.val();var h=c.data("uii");var i=_placester.entitlementsHandler.shouldFireFbPixelLeadEvent();var j=_placester&&_placester.fbPixelConfig&&_placester.fbPixelConfig.fb_pixel_id?true:false;if($(a).data("requestRunning")){return}$(f).val(getLocalizedText("Loading","officeSearchForm.loading"));if(c.find("input[name='action']").val()==="pl_register_site_user"){var k=/^[a-zA-Z]+$/;var l=new URLSearchParams(c.serialize());if(l.get("first_name")){if(!k.test(l.get("first_name"))){c.find(".error").show();c.find(".error").empty();c.find(".error").text(c.find('input[name="first_name"]').data("message"));return}}if(l.get("last_name")){if(!k.test(l.get("last_name"))){c.find(".error").show();c.find(".error").empty();c.find(".error").text(c.find('input[name="last_name"]').data("message"));return}}}$(a).data("requestRunning",true);$.ajax({type:"POST",url:info.ajaxurl,data:c.serialize(),dataType:"json",success:function(f){if(f&&f.success){$(".form-validator-error").remove();var g=$(a).closest(".pl_fbox--inner").find(".success");var k=$(a).find(".additional-message");if(g){d.slideUp();if(typeof pl_inject_conversion_snippet==="function"&&c.hasClass("pl_leadRegister"))pl_inject_conversion_snippet();if(j&&i&&e!="pl_login_site_user"){try{fbq("track","Lead")}catch(l){console.warn("Error tracking Facebook Pixel event.")}}setTimeout(function(){if(f.message){g.html(f.message)}g.show("fast");if(f.additional_message){k.html(f.additional_message);k.show("fast")}},500);switch(e){case"pl_login_site_user":case"pl_login_password":setTimeout(function(){window.location.replace(_placester.searchAppConfig.site_url)},1500);case"pl_register_site_user":b.setLeadCaptured();if(b.deferred_action.action&&b.deferred_action.action=="add_favorite_property"){b.handleDeferredAction(b.deferred_action)}}if(typeof _placester.uii==="object"){_placester.uii.addToPayLoad("lead_uuid",f.lead_uuid,true);_placester.uii.send({event:h,interaction_data:{action:"submit-success",element_data_type:"target",element_data:_placester.uii.getElementData(c.get(0))},form_data:_placester.uii.formSerializer(c.get(0))})}if(f.auto_reload){if(b.deferred_action.action){$.cookies.set("deferred_action",b.deferred_action)}setTimeout(function(){window.location.reload(true)},1e3)}}}else{b.handleFormErrors(c,f);if(typeof _placester.uii==="object"){_placester.uii.send({event:h,interaction_data:{action:"submit-error",result:f,element_data_type:"target",element_data:_placester.uii.getElementData(c.get(0))},form_data:_placester.uii.formSerializer(c.get(0))})}}},complete:function(){$(a).data("requestRunning",false);$(f).val(g)}})},handleDeferredAction:function(a){var b=window[a.action.context];if(typeof b==="object"&&typeof b[a.action.fn]==="function"){b[a.action.fn](a.args)}},addFavorite:function(a){var b=$('a[href="#'+a.property_id+'"].pl_add_favorite');var c=$(b).parent().find(".pl_spinner");c.show();$.post(info.ajaxurl,a,function(a){c.hide();if(a&&a.is_admin){alert('Sorry, admins currently aren\'t able to maintain a list of "favorite" listings')}else if(a&&a.id){$(b).hide();$(b).parent().find(".pl_remove_favorite").show();if(jQuery("body").hasClass("single-property")&&window.enableRecoloradoTrac&&recolorado_fflm){recolorado_fflm.TrackFavorite()}if(typeof _LT!=="undefined"&&_LT!==null&&window.enableListTrac&&jQuery("body").hasClass("single-property")){_LT._trackEvent(_eventType.favorite,window.listTrac["listingId"],window.listTrac["postal"])}}else{console.log("Error adding favorite...")}},"json")},setLeadCaptured:function(){var a=new Date(2147483647e3);jQuery.cookies.set("lead_capture_visitor",1,{expiresAt:a})},isLeadCaptured:function(){return $.cookies.get("lead_capture_visitor")},setLeadCaptureFormReset:function(){if($.cookies.get("pl_lc_reset_ts")){document.cookie="pl_lc_reset_ts"+"=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;"}jQuery.cookies.set("pl_lc_reset_ts",Date.now())},showLeadCapture:function(){if(typeof getTemplateName==="function"&&getTemplateName()==="Highland"){$(window).trigger("pl_leadCaptureForm")}else{var a=this;setTimeout(function(){$.fancybox.open("#pl_leadCapture",{fitToView:false,autoSize:true,maxWidth:"85%",padding:0,scrolling:"no",wrapCSS:"pl_fbox pl_fbox-leadCapture",beforeClose:function(){if(window.redirectFromNonDismissableLeadCapture){a.resetForm(this);a.setLeadCaptureFormReset()}else{if((typeof pl_lc_force_back==="undefined"||pl_lc_force_back==1)&&!a.isLeadCaptured()){a.resetForm(this);window.location=typeof pl_lc_redirect!=="undefined"?pl_lc_redirect:"/";return false}else{a.resetForm(this);a.setLeadCaptureFormReset()}}}});if(typeof _placester.uii==="object"){var b=$("#pl_leadCapture form");var c=b.data("uii");_placester.uii.send({event:c,interaction_data:{action:"show",element_data_type:"target",element_data:_placester.uii.getElementData(b.get(0))}})}},200)}},sendConfirmationEmail:function(){var a=this;var b={action:"resend_confirmation"};$.post(info.ajaxurl,b,function(a){if(a&&a.success){$("#pl_emailConfirmation footer").hide();var b=$("#pl_emailConfirmation p");b.addClass("success");b.text("Please check your email to confirm your account.");b.show()}},"json")},checkShowLeadCapture:function(a){return $.ajax({url:"/wp-admin/admin-ajax.php",data:{action:"show_lead_capture",pageType:a},type:"POST",dataType:"json"})},processShowLeadCapture:function(a,b){if(b!="success"||!a){return}if(a.pl_lc_show){var c=$("#pl_leadCapture_desc_box");if(c&&c.length){var d=c[0].outerText;if(d.includes("tube")){var e=/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&\/\/=]*)/g,f='<iframe width="323" height="323" src="',g='?autoplay=1" frameborder="0" allow="encrypted-media" allowfullscreen></iframe>',h=d.match(e),i=h.toString(),j=i.length,k=d.indexOf(i),l=d.replace(e,""),m=l.toString(),n=m.trim(),o=d.indexOf(n);if(o>=k){var p=f+i+g+" "+l;c.html(p)}else if(o>=0&&o<k){var p=l+" "+f+i+g;c.html(p)}else if(o===-1){var q=d.slice(0,k),r=d.slice(k+j),p=q+" "+f+i+g+" "+r;c.html(p)}}}this.showLeadCapture()}}};jQuery(document).ready(function(a){if(typeof a.fancybox=="function"){pl_membership.init()}});if(typeof google!=="undefined"&&google.maps){google.maps.Polygon.prototype.extendBounds=function(a){if(typeof a==="undefined"){a=new google.maps.LatLngBounds}this.getPath().forEach(function(b,c){a.extend(b)});return a}}function PL_Metro_Map(){this.map=null;this.current_polygon=null;this.hover_polygon=null;this.infoWindow=null;this.container=null;this.metro_map_options={strokeOpacity:.8,strokeWeight:2,fillOpacity:.4,fillColor:"#BDBDBD",strokeColor:"#999999",selected_fillOpacity:.4,selected_fillColor:"#2096f3",selected_strokeColor:"#1565C0"}}PL_Metro_Map.prototype.initialize_metro_map=function(a,b){var c=this;if(typeof a==="undefined"){a="get_all_neighborhoods_map"}if(typeof b==="undefined"){b=false}var d=new google.maps.LatLngBounds;c.infoWindow=new google.maps.InfoWindow;c.map=new google.maps.Map(document.getElementById(a),{center:{lat:42.37,lng:-71.03},mapTypeId:google.maps.MapTypeId.ROADMAP,disableDefaultUI:true,zoomControl:true,scrollwheel:false});if(typeof window._placester!=="undefined"&&window._placester.map_styles){this.map.setOptions({styles:window._placester.map_styles})}c.container=jQuery("#"+a).parent();var e=[];jQuery.each(_placester.metroNeighborhoods,function(a,b){e.push({polygon:new google.maps.Polygon({paths:b.paths,strokeColor:c.metro_map_options.strokeColor,strokeOpacity:c.metro_map_options.strokeOpacity,strokeWeight:c.metro_map_options.strokeWeight,fillColor:c.metro_map_options.fillColor,fillOpacity:c.metro_map_options.fillOpacity}),area:b.area,area_id:b.area_id,area_title:b.area_title})});function f(a){var b=new google.maps.LatLngBounds;a.getPath().forEach(function(a,c){b.extend(a)});return b}jQuery.each(e,function(a,e){e.polygon.setMap(c.map);d=f(e.polygon);google.maps.event.addListener(e.polygon,"click",function(a){c.hilight_neighborhood_polygon(a,this,e)});google.maps.event.addListener(e.polygon,"mouseover",function(a){hover_polygon=this;c.mouseOver_polygon(a,hover_polygon,e);google.maps.event.addListenerOnce(c.map,"mousemove",function(a){c.mouseOut_polygon(a,hover_polygon,e)})});if(b&&b==e.area_id){c.current_polygon=e.polygon;c.mouseOver_polygon(null,e.polygon,e)}});if(c.current_polygon){c.map.fitBounds(f(c.current_polygon));c.current_polygon.setOptions({strokeColor:this.metro_map_options.selected_strokeColor,strokeOpacity:this.metro_map_options.selected_strokeOpacity,fillColor:this.metro_map_options.selected_fillColor})}else{c.map.fitBounds(d)}c.container.on("click",".neighborhood_map_details_tab",function(a){jQuery(a.target).closest(".metro-area-widget-map").toggleClass("show-detail");setTimeout(function(){google.maps.event.trigger(c.map,"resize");if(c.current_polygon){c.map.fitBounds(f(c.current_polygon))}},550)})};PL_Metro_Map.prototype.mouseOver_polygon=function(a,b,c){if(this.hover_polgon&&this.hover_polgon===b){return}else if(this.hover_polygon&&this.hover_polygon!==b){this.mouseOut_polygon(a,this.hover_polygon,this.hover_area)}this.hover_polygon=b;b.setOptions({strokeColor:this.metro_map_options.selected_strokeColor,strokeOpacity:this.metro_map_options.selected_strokeOpacity,fillColor:this.metro_map_options.selected_fillColor});var d=b.extendBounds().getCenter();var e="<b>"+c.area_title+"</b>";this.infoWindow.setContent(e);this.infoWindow.setPosition(d);this.infoWindow.open(this.map)};PL_Metro_Map.prototype.mouseOut_polygon=function(a,b,c){this.hover_polygon=null;if(this.current_polygon&&b===this.current_polygon){return}b.setOptions({strokeColor:this.metro_map_options.strokeColor,strokeOpacity:this.metro_map_options.strokeOpacity,fillColor:this.metro_map_options.fillColor});this.infoWindow.close()};PL_Metro_Map.prototype.hilight_neighborhood_polygon=function(a,b,c){this.load_neighborhood_details(c.area_id,{target:".neighborhood_map_details"});if(this.current_polygon){this.current_polygon.setOptions({strokeColor:this.metro_map_options.strokeColor,strokeOpacity:this.metro_map_options.strokeOpacity,fillColor:this.metro_map_options.fillColor})}b.setOptions({strokeColor:this.metro_map_options.selected_strokeColor,strokeOpacity:this.metro_map_options.selected_strokeOpacity,fillColor:this.metro_map_options.selected_fillColor});this.current_polygon=b;var d="<b>"+c.area_title+"</b>";this.infoWindow.setContent(d);this.infoWindow.setPosition(a.latLng);this.infoWindow.open(this.map);var e=b.extendBounds();this.container.removeClass("hide-detail-tab");if(this.container.is(".show-detail")){this.map.fitBounds(e)}else{this.container.addClass("show-detail");self=this;self.map.fitBounds(e);setTimeout(function(){google.maps.event.trigger(self.map,"resize");self.map.fitBounds(e)},550)}};PL_Metro_Map.prototype.single_neighborhood_map=function(a){var b=new google.maps.Polygon({paths:a,strokeColor:this.metro_map_options.selected_strokeColor,strokeOpacity:this.metro_map_options.strokeOpacity,strokeWeight:this.metro_map_options.strokeWeight,fillColor:this.metro_map_options.selected_fillColor,fillOpacity:this.metro_map_options.selected_fillOpacity});this.map=new google.maps.Map(document.getElementById("metro-small-widget"),{zoom:12,center:a[0],mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControl:false,disableDefaultUI:true,zoomControl:true,scrollwheel:false});if(typeof window._placester!=="undefined"&&window._placester.map_styles){this.map.setOptions({styles:window._placester.map_styles})}b.setMap(this.map)};PL_Metro_Map.prototype.load_neighborhood_details=function(a,b){if(typeof b==="undefined"){b={}}b.target=b.target||".neighborhood_map_details";b.success=b.success||function(a){if(a){$(b.target).html(a)}};b.complete=b.complete||function(){$(b.target).parent().removeClass("loading")};b.error=b.error||function(){$(b.target).parent().removeClass("loading");alert("Sorry, something went wrong")};$(b.target).parent().addClass("loading");return jQuery.ajax({url:"/wp-admin/admin-ajax.php",method:"POST",data:{action:"metro_get_area",post_id:a},success:b.success,error:b.error,complete:b.complete})};function PL_Metro_Neighborhoods(){}PL_Metro_Neighborhoods.prototype.initialize_metro_neighborhoods=function(){var a=this;jQuery("#neighborhood_map_details").find(".metro-area-svg").appendTo(jQuery("#metro-neighborhood-polygon-wrapper").html(""));if(jQuery(".widget-metro-neighborhood .metro-neighborhood-select ul").height()+20>jQuery(".widget-metro-neighborhood .metro-neighborhood-select-wrapper").height()){jQuery(".widget-metro-neighborhood .metro-neighborhood-select-wrapper").addClass("overflow")}jQuery(".metro-neighborhood-select").on("click","ul a",function(b){b.preventDefault();var c=jQuery(b.target);jQuery(".metro-neighborhood-select ul a.selected").removeClass("selected");c.addClass("selected");a.getMetroNeighborhoodList(c.data("area_id"))});jQuery(".metro-neighborhood-select-mobile-menu").on("change",function(b){var c=jQuery(b.target);a.getMetroNeighborhoodList(c.val())})};PL_Metro_Neighborhoods.prototype.getMetroNeighborhoodList=function(a){$(".neighborhood_map_details_pane").addClass("loading");jQuery.ajax({url:"/wp-admin/admin-ajax.php",method:"POST",data:{action:"metro_get_area",post_id:a,include_polygon:true},success:function(a){if(a){jQuery("#neighborhood_map_details").html(a);jQuery("#neighborhood_map_details").find(".metro-area-svg").appendTo(jQuery("#metro-neighborhood-polygon-wrapper").html(""))}},complete:function(){jQuery(".neighborhood_map_details_pane").removeClass("loading")}})};function Neighborhood(a){var b=this;this.map=a.map||false;this.type=a.type||"neighborhood";this.strokeColor=a.strokeColor||null;this.strokeOpacity=a.strokeOpacity||null;this.strokeWeight=a.strokeWeight||null;this.fillColor=a.fillColor||null;this.fillOpacity=a.fillOpacity||null;this.neighborhood_override=false;this.slug=a.slug||false;this.name=a.name||false;Neighborhood.prototype.polygon_click=a.polygon_click||function(a){b.map.selected_polygon=a;b.map.polygons_exclude_center=true;b.map.always_center=true;b.map.listings.get();for(var c=b.map.polygons.length-1;c>=0;c--){b.map.polygons[c].setOptions({fillOpacity:"0.4"})}a.setOptions({fillOpacity:"0.6"})};Neighborhood.prototype.polygon_mouseover=a.polygon_mouseover||function(a){a.setOptions({fillOpacity:"0.9"})};Neighborhood.prototype.polygon_mouseout=a.polygon_mouseout||function(a){a.setOptions({fillOpacity:"0.4"})}}Neighborhood.prototype.init=function(){var a=this;var b={};if(this.slug){b.action="get_polygons_by_slug";b.slug=this.slug;b.type=this.type}else{b.action="get_polygons_by_type";b.type=this.type}jQuery.ajax({dataType:"json",type:"POST",url:info.ajaxurl,data:b,success:function(b){if(b.length>0){var c,d;for(var e=b.length-1;e>=0;e--){if(typeof b[e].permalink!=="string"){continue}c=a.process_neighborhood_polygon(b[e]);d=a.map.create_polygon(c);if(a.slug){a.map.selected_polygon=d;a.map.filter_by_bounds=true;a.map.listings.get()}}if(a.map.center_map_on_polygons){a.map.center_on_polygons()}}else{a.neighborhood_override=true;a.map.listings.filter_override=[];a.map.listings.filter_override.push({name:"location["+a.type+"]",value:a.name});a.map.listings.filter_override.push({name:"location["+a.type+"_match]",value:"eq"});a.map.listings.get()}}})};Neighborhood.prototype.process_neighborhood_polygon=function(a){var b={};b.paths=[];b.label=a.name||false;b.tax=a.tax||false;b.permalink=a.permalink||false;b.strokeColor=this.strokeColor||a.settings.border.color;b.strokeOpacity=this.strokeOpacity||a.settings.border.opacity;b.strokeWeight=this.strokeWeight||a.settings.border.weight;b.fillColor=this.fillColor||a.settings.fill.color;b.fillOpacity=this.fillOpacity||a.settings.fill.opacity;if(a.vertices.length>0){var c=new google.maps.LatLngBounds;for(var d=a.vertices.length-1;d>=0;d--){var e=a.vertices[d];var f=new google.maps.LatLng(e["lat"],e["lng"]);b.paths.push(f);this.map.polygons_verticies.push(f);c.extend(f)}b.label_center=c.getCenter()}b.vertices=a.vertices;return b};function POI(){}POI.prototype.init=function(a){var b=this;this.map=a.map||alert("You need to give the POI object a map");this.form_id=a.form_id||alert("You need to provide the id of the form that has the checkbox controls.");this.status_window_header=a.status_window_header||"<h5>Point of Interest</h5>";this.status_window_content=a.status_window_content||'<p id="start_warning">Use controls below to select what points of interests you\'d like to see on the map</p>';this.search_radius=a.search_radius||5e3;this.use_google_icons=a.use_google_icons||false;this.default_icon=a.default_icon||"https://chart.googleapis.com/chart?chst=d_map_spin&chld=0.3|0|FF8429|13|b";this.markers=[];this.infowindows=[];this.all_markers=[];if(this.map.status_window){google.maps.event.addDomListenerOnce(this.map.map,"idle",function(){var a='<div id="polygon_display_wrapper">';a+=b.status_window_header;a+=b.status_window_content;a+="</div>";jQuery("#"+b.map.status_window.dom_id).append(a)})}jQuery(this.form_id).on("change",function(a){a.preventDefault();b.clear_markers();b.search_places()})};POI.prototype.update=function(){this.update_all_marker_list();this.center_on_markers()};POI.prototype.update_all_marker_list=function(){var a=[];for(var b=this.map.markers.length-1;b>=0;b--){a.push(this.map.markers[b])}for(var b=this.markers.length-1;b>=0;b--){a.push(this.markers[b])}this.all_markers=a};POI.prototype.clear_markers=function(){if(this.markers){for(var a=this.markers.length-1;a>=0;a--){this.markers[a].setMap(null)}this.markers=[]}};POI.prototype.create_marker=function(a){var b=this;var c=new google.maps.Marker(a);var d=new google.maps.InfoWindow({content:a.content});this.infowindows.push(d);google.maps.event.addListener(c,"click",a.click||function(){for(var a=b.infowindows.length-1;a>=0;a--){b.infowindows[a].setMap(null)}d.open(b.map.map,c)});c.setMap(this.map.map);this.markers.push(c)};POI.prototype.search_places=function(){var a=this;var b=this.get_POI_form();var c=new google.maps.places.PlacesService(this.map.map);c.search(b,function(b,c){var d=[];if(c==google.maps.places.PlacesServiceStatus.OK){for(var e=0;e<b.length;e++){var f={position:new google.maps.LatLng(b[e].geometry.location.lat(),b[e].geometry.location.lng()),content:b[e].name,icon:a.default_icon,listing:b[e]};if(a.use_google_icons){f.icon=b[e].icon}a.create_marker(f)}}a.update_all_marker_list();a.center_on_markers()})};POI.prototype.get_POI_form=function(){var a={location:new google.maps.LatLng(this.map.lat,this.map.lng),radius:this.search_radius,types:[""]};var b=[];jQuery.each(jQuery(this.form_id).serializeArray(),function(a,c){b.push(c.name)});if(b.length>0){a.types=[];for(key in b){a.types.push(b[key])}}return a};POI.prototype.center_on_markers=function(){var a=new google.maps.LatLngBounds;for(var b=this.all_markers.length-1;b>=0;b--){a.extend(this.all_markers[b].getPosition())}this.map.map.fitBounds(a)};jQuery(document).ready(function(a){a("#print-listing").click(function(a){window.print()});a(".pl_listing-shareButton").click(function(){var b=a(this).attr("data-uii");var c=null;if(b==="share:listing:print"){c="printListing"}else if(b==="share:listing:pinterest"||b==="share:listing:facebook"||b==="share:listing:twitter"||b==="share:listing:linkedin"){c="share"}if(jQuery("body").hasClass("single-property")&&window.enableRecoloradoTrac&&recolorado_fflm&&c==="printListing"){recolorado_fflm.TrackPrint()}else if(jQuery("body").hasClass("single-property")&&window.enableRecoloradoTrac&&recolorado_fflm&&c==="share"){recolorado_fflm.TrackShare()}eventForListingtrack(c)});a(".v-tour").click(function(){eventForListingtrack("vTour")});var b=function(){a("body").removeClass("f-nav")};if(window.matchMedia){var c=window.matchMedia("print");c.addListener(function(a){if(a.matches){b()}})}window.onbeforeprint=b});function eventForListingtrack(a){if(a&&typeof _LT!=="undefined"&&_LT!==null&&window.enableListTrac&&jQuery("body").hasClass("single-property")){_LT._trackEvent(_eventType[a],window.listTrac["listingId"],window.listTrac["postal"])}}var pl_savedSearch={form_key_translations:{"location[locality]":getLocalizedText("City","savedSearchApp.city"),locality:getLocalizedText("City","savedSearchApp.city"),"location[postal]":getLocalizedText("Zip","savedSearchApp.zip"),zip:getLocalizedText("Zip","savedSearchApp.zip"),"location[address]":getLocalizedText("Street","savedSearchApp.street"),address:getLocalizedText("Street","savedSearchApp.street"),"location[neighborhood]":getLocalizedText("Neighborhood","savedSearchApp.neighborhood"),neighborhood:getLocalizedText("Neighborhood","savedSearchApp.neighborhood"),"location[region]":getLocalizedText("State","savedSearchApp.state"),region:getLocalizedText("State","savedSearchApp.state"),"location[county]":getLocalizedText("County","savedSearchApp.county"),county:getLocalizedText("County","savedSearchApp.county"),property_type:getLocalizedText("Property Type","savedSearchApp.propertyType"),placester_prop_type:getLocalizedText("Property Type","savedSearchApp.propertyType"),purchase_types:getLocalizedText("Available for","savedSearchApp.availablefor"),"purchase_types[]":getLocalizedText("Available for","savedSearchApp.availablefor"),"metadata[min_sqft]":getLocalizedText("Min Sqft","savedSearchApp.minSqft"),min_sqft:getLocalizedText("Min Sqft","savedSearchApp.minSqft"),"metadata[max_sqft]":getLocalizedText("Max Sqft","savedSearchApp.maxSqft"),max_sqft:getLocalizedText("Max Sqft","savedSearchApp.maxSqft"),"metadata[min_beds]":getLocalizedText("Min Beds","savedSearchApp.minBeds"),min_beds:getLocalizedText("Min Beds","savedSearchApp.minBeds"),max_beds:getLocalizedText("Max Beds","savedSearchApp.maxBeds"),"metadata[min_baths]":getLocalizedText("Min Baths","savedSearchApp.minBaths"),min_baths:getLocalizedText("Min Baths","savedSearchApp.minBaths"),max_baths:getLocalizedText("Max Baths","savedSearchApp.maxBaths"),"metadata[min_price]":getLocalizedText("Min Price","savedSearchApp.minPrice"),min_price:getLocalizedText("Min Price","savedSearchApp.minPrice"),"metadata[max_price]":getLocalizedText("Max Price","savedSearchApp.maxPrice"),max_price:getLocalizedText("Max Price","savedSearchApp.maxPrice"),min_year_built:getLocalizedText("Min Year Built","savedSearchApp.minYearBuilt"),max_year_built:getLocalizedText("Max Year Built","savedSearchApp.maxYearBuilt"),mls_id:getLocalizedText("MLS #","savedSearchApp.mls"),text_search:getLocalizedText("Query","savedSearchApp.query"),filter_city_names:getLocalizedText("Cities","savedSearchApp.cities"),filter_states:getLocalizedText("States","savedSearchApp.states"),filter_neighborhood_names:getLocalizedText("Neighborhoods","savedSearchApp.neighborhoods"),filter_zips:getLocalizedText("Zip Codes","savedSearchApp.zipCodes"),kwls_id:getLocalizedText("KWLS #","savedSearchApp.kwls"),open_house_filters_start_utc:getLocalizedText("Open Houses","savedSearchApp.openHouse"),keyword:getLocalizedText("Keyword(s)","savedSearchApp.keywords"),raw_prop_type:getLocalizedText("Property Type:","savedSearchApp.rawPropType"),area:getLocalizedText("Area","savedSearchApp.area"),raw_neighborhood:getLocalizedText("Neighborhood","savedSearchApp.rawNeighborhood"),sub_area:getLocalizedText("Subarea","savedSearchApp.subArea"),subdivision:getLocalizedText("Subdivision","savedSearchApp.subdivision"),community_name:getLocalizedText("Community Name","savedSearchApp.communityName"),complex_name:getLocalizedText("Complex Name","savedSearchApp.complexName"),building_name:getLocalizedText("Building Name","savedSearchApp.buildingName")},init:function(){$=jQuery;var a=this;if(typeof $.fancybox=="function"){$(".pls_save_search").click(function(b){b.preventDefault();if(!pl_membership.loggedIn()){document.getElementById("auto_form_type").value="form:registration_saved_search";var c={deferred_action:{context:"pl_savedSearch",fn:"newSavedSearch"}};pl_membership.showSignupForm(c)}else{var d=$("#pl_emailConfirmation");if(d.length){return}a.newSavedSearchForm()}});if(!(typeof getTemplateName==="function"&&getTemplateName()==="Highland")){$(".pl_widget-savedSearch-edit").fancybox({fitToView:false,autoSize:true,maxWidth:"85%",padding:0,scrolling:"no",wrapCSS:"pl_fbox pl_fbox-saved-search",beforeLoad:function(){var a=$("#pl_savedSearch").find("form");var b=a.find("input[name=update]");var c=this.element.data("search");var d=$("#"+c+" .pl_widget-savedSearch-name").text();var e=$("#"+c+" .frequency").data("frequency");$("#pl_savedSearch-notifications").val(e).trigger("chosen:updated");$("#pl_savedSearch-searchName").val(d);if(b.length){b.val(c)}else{a.append("<input type='hidden' name='update' value='"+c+"'></input>")}},afterClose:function(){var a=this;$("#pl_savedSearch").find("form").each(function(){this.reset()})}})}}$("#pl_submit").on("click",function(b){b.preventDefault();var c=$("#pl_savedSearch").find("form");var d=c.find("input[name=update]");if(!a.validateSavedSearchForm(c)){return}if(d.length){var e=$("#pl_savedSearch-notifications").val();var f=$("#pl_savedSearch-searchName").val();a.updateSearchFilters(d.val(),{notifications:e,name:f})}else{a.saveSearchFilters()}});$(".pl_save-search--submit").on("click",function(b){b.preventDefault();var c=$(".pl_popup-wrapper").find("form");var d=c.find("input[name=update]");if(!a.validateSavedSearchForm(c)){return}if(d.length){var e=$(".pl_savedSearch-notify .chosen-container .chosen-single span").text().trim().toLowerCase();if(!e||e=="do not notify me"||e==""){e="none"}var f=$(".pl_popup-wrapper #pl_savedSearch-searchName").val();a.updateSearchFilters(d.val(),{notifications:e,name:f},true)}else{a.saveSearchFiltersHighland()}});$(".pl_widget-savedSearch-show").on("click",function(b){b.preventDefault();var c=$(this).attr("href");var d=$("#pl_widget-savedSearch-"+c);var e=$("#"+c);if(e.hasClass("modified")){a.updateSearchFilters(c,{status:"viewed"})}if(d.is(":visible")){$(this).html("Show")}else{$(this).html("Show")}d.toggle("slow")});$(".pl_widget-savedSearch-remove").on("click",function(a){a.preventDefault();var b={action:"delete_saved_search",saved_search_id:$(this).attr("href")};$.post(info.ajaxurl,b,function(a,c,d){if(a&&a.success){$(".pl_widget-savedSearch#"+b.saved_search_id).remove();if($("#savedSearchLists").children().length==0){$("#savedSearchLists").append("<li>"+getLocalizedText("You haven't saved any saved searches.","savedSearchApp.savedSearchesMessage")+"</li>")}}},"json")})},newSavedSearch:function(){var a=this;var b=6;var c=setInterval(function(){b--;var d=a.getSearchFilters();if(!$.isEmptyObject(d)){clearInterval(c);a.newSavedSearchForm();return}if(!b){clearInterval(c)}},500)},newSavedSearchForm:function(){if(typeof getTemplateName==="function"&&getTemplateName()==="Highland"){$(window).trigger("pl_saveSearchForm")}else{var a=this;$.fancybox({href:"#pl_savedSearch",fitToView:false,autoSize:true,maxWidth:"85%",padding:0,
scrolling:"no",wrapCSS:"pl_fbox pl_fbox-saved-search",beforeLoad:function(){a.appendSearchFilters();$(".pl_savedSearch-innerWrapper").show();$(".pls_save_search select").trigger("chosen:updated")},afterClose:function(){var a=this;$("#pl_savedSearch").find("form").each(function(){this.reset()})}})}},saveSearchFiltersHighland:function(){var a=this;var b=typeof window.location.hash=="undefined"?"":window.location.hash;var c=window.location.pathname+b;var d={action:"add_saved_search",search_url_path:c,search_name:$(".pl_popup-wrapper #pl_savedSearch-searchName").val(),search_notifications:$(".pl_popup-wrapper .pl_savedSearch-select").val(),search_filters:$.param(a.getSearchFilters())};$.post(info.ajaxurl,d,function(a,b,c){var e=$(".pl_popup-wrapper #pl_savedSearch-message");if(a&&a.success){e.attr("class","success")}else{e.attr("class","error")}e.html(a.message).show();if(typeof _placester.uii==="object"){_placester.uii.send({event:"form:saved-search",interaction_data:{action:"submit",result:a,element_data_type:"target",element_data:_placester.uii.getElementData($(".pl_popup-wrapper form").get(0))},form_data:d})}$(window).trigger("pl_savedSearchCloseModal")},"json")},afterUpdateSearchFiltersHighland:function(a){var b=$(".pl_popup-wrapper #pl_savedSearch-message");if(a&&a.success){b.attr("class","success");var c=a.success.id;$("#"+c+" .pl_widget-savedSearch-name").text(a.success.savedsearch_name);var d=$("#"+c+" .frequency");var e=a.success.notifications=="none"?"no":a.success.notifications;d.text(capitalize(e)+" notifications");d.data("frequency",a.success.notifications)}else{b.attr("class","error")}b.html(a.message).show();$(window).trigger("pl_savedSearchCloseModal")},saveSearchFilters:function(){var a=this;var b=typeof window.location.hash=="undefined"?"":window.location.hash;var c=window.location.pathname+b;var d={action:"add_saved_search",search_url_path:c,search_name:$("#pl_savedSearch-searchName").val(),search_notifications:$("#pl_savedSearch-notifications").val(),search_filters:$.param(a.getSearchFilters())};$.post(info.ajaxurl,d,function(a,b,c){if(a&&a.success){$("#pl_savedSearch-message").attr("class","success")}else{$("#pl_savedSearch-message").attr("class","error")}$("#pl_savedSearch-message").html(a.message);$("#pl_savedSearch-message").show();if(typeof _placester.uii==="object"){_placester.uii.send({event:"form:saved-search",interaction_data:{action:"submit",result:a,element_data_type:"target",element_data:_placester.uii.getElementData($("#pl_savedSearch form").get(0))},form_data:d})}setTimeout(function(){$("#pl_savedSearch-message").fadeOut();$.fancybox.close()},2e3)},"json")},updateSearchFilters:function(a,b,c){var d=this;var e={action:"update_saved_search",updated_fields:b,search_id:a};$.post(info.ajaxurl,e,function(a,b,e){if(c){d.afterUpdateSearchFiltersHighland(a)}else{if(a&&a.success){$("#pl_savedSearch-message").attr("class","success");var f=a.success.id;$("#"+f+" .pl_widget-savedSearch-name").text(a.success.savedsearch_name);var g=$("#"+f+" .frequency");var h=a.success.notifications=="none"?"no":a.success.notifications;g.text(capitalize(h)+" notifications");g.data("frequency",a.success.notifications)}else{$("#pl_savedSearch-message").attr("class","error")}$("#pl_savedSearch-message").html(a.message);$("#pl_savedSearch-message").show();setTimeout(function(){$("#pl_savedSearch-message").fadeOut();$.fancybox.close()},2e3)}},"json")},getSearchFilters:function(){var a=this;var b={};var c=[];var d={};var e=["location[address_match]","sort_by","sort_type","search_num_results","sub_region_filter","gm_polygon_coords"];if(typeof search_bootloader!=="undefined"){b=search_bootloader.filter.get_values()}else{b=$(".pls_search_form_listings").find("input[name], select[name]").serializeArray()}$.each(_placester.searchAppConfig.listings.filters,function(a,b){c.push({name:a,value:b})});var f=$.merge(c,b);$.each(f,function(a,b){if(b.value!==""&&b.value!="0"&&e.indexOf(b.name)==-1){d[b.name]=b.value}});if($(".sub_region_filter").length>0){var g=JSON.parse($(".sub_region_filter").val());$.each(g,function(a,b){d["sub_region_filter"+a]=b});d["sub_region_length"]=g.length}if($(".gm_polygon_coords").length>0){var h=JSON.parse($(".gm_polygon_coords").val());$.each(h,function(a,b){d["gm_polygon_coords"+a]=JSON.stringify(b)});d["gm_polygon_length"]=h.length}return d},validateSavedSearchForm:function(a){if(jQuery().validator){var b=a.find("input[required]").validator({messageClass:"form-validator-error",message:"<div><span></span></div>",position:"top center"});return b.data("validator").checkValidity()}else{return true}},appendSearchFilters:function(){var a=this;var b=a.getSearchFilters();$("#pl_savedSearch-filters ul").empty();for(var c in b){var d=b[c];var e=$('[name="'+c+'"]');if(e.attr("type")=="select"){d=e.find("option[value='"+d+"']").text()}else{d=e.val()}if(typeof purchase_type=="undefined"||d==""){d=b[c]}if(a.form_key_translations.hasOwnProperty(c)){c=a.form_key_translations[c]}var f="<li class='pl_savedSearch-filter'><span class='pl_savedSearch-filterName'>"+c+":</span><span class='pl_savedSearch-filterValue'> ";if(d==="buy"){f=f+getLocalizedText("buy","savedSearchApp.buy")}else if(d==="rental"){f=f+getLocalizedText("rental","savedSearchApp.rental")}else{f=f+d}f=f+"</span></li>";$("#pl_savedSearch-filters ul").append(f)}return true}};function capitalize(a){return a.replace(/(?:^|\s|\/)\S/g,function(a){return a.toUpperCase()})}jQuery(document).ready(function(a){pl_savedSearch.init()});function SearchLoader(a){this.is_inited=false;this.params={};if(!a){return this}this.params=a;this.init()}SearchLoader.prototype.init=function(){this.is_inited=true;this.listings={};this.map=false;this.list=false;this.filter=false;this.poi=false;this.init_params();if(this.params.map||this.params.filter||this.params.list||this.params.poi){this.create_objects();this.init_objects();this.listings.init()}else{alert("You didn't ask for filters, a list, or a map - why are you using the bootloader? ")}};SearchLoader.prototype.init_params=function(){var a=this;this.map_params=function(){if(a.params.map&&typeof Map!=="function")return false;if(a.params.map instanceof Object){a.params.map.type=a.params.map.type||"listings";return a.params.map}return{type:"listings"}}();this.list_params=function(){if(a.params.list&&typeof List!=="function")return false;if(a.params.list instanceof Object)return a.params.list;return{}}();this.filter_params=function(){if(a.params.filter&&typeof Filters!=="function")return false;if(a.params.filter instanceof Object)return a.params.filter;return{}}();this.poi_params=function(){if(a.params.poi&&typeof POI!=="function")return false;if(a.params.poi instanceof Object)return a.params.poi;return{}}()};SearchLoader.prototype.create_objects=function(){this.listings_params={};if(this.params.map&&typeof Map==="function"){this.map=new Map;this.listings_params.map=this.map;this.filter_params.map=this.map;this.list_params.map=this.map;this.poi_params.map=this.map}if(this.params.filter&&typeof Filters==="function"){this.filter=new Filters;this.listings_params.filter=this.filter;if(this.params.filter.default_filters){this.listings_params.default_filters=this.params.filter.default_filters}this.list_params.filter=this.filter;this.map_params.filter=this.filter}if(this.params.list&&typeof List==="function"){this.list=new List;this.listings_params.list=this.list;this.filter_params.list=this.list;this.map_params.list=this.list}if(this.params.poi&&typeof POI==="function"){this.poi=new POI;this.map_params.poi=this.poi}this.listings=new Listings(this.listings_params);if(this.params.map)this.map_params.listings=this.listings;if(this.params.filter)this.filter_params.listings=this.listings;if(this.params.list)this.list_params.listings=this.listings;if(this.params.poi)this.poi_params.listings=this.listings};SearchLoader.prototype.init_objects=function(){if(this.params.map&&this.map){if(this.params.map.type==="neighborhood"){var a={map:this.map};if(this.params.map.neighborhood instanceof Object){a=this.params.map.neighborhood;a.map=this.map}this.params.map.neighborhood=new Neighborhood(a)}this.map.init(this.map_params)}if(this.params.filter&&this.filter){this.filter.init(this.filter_params)}if(this.params.list&&this.list){this.list.init(this.list_params)}if(this.params.poi&&this.poi){this.poi.init(this.poi_params)}};SearchLoader.prototype.add_param=function(a){for(var b in a){if(!this.params.hasOwnProperty(b)){this.params[b]=a[b]}}};var pl_showing_request={deferred_action:{},init:function(){$=jQuery;var a=this;if(typeof $.fancybox=="function"){$(".pl_request_showing_link").click(function(b){b.preventDefault();a.showShowingRequestForm()})}},showShowingRequestForm:function(){var a=this;a.deferred_action={};a.openForm("#pl_showingRequest")},openForm:function(a,b){var c=this;b=b||null;$.fancybox(a,{fitToView:true,autoSize:true,padding:0,scrolling:"auto",wrapCSS:"pl_fbox",beforeClose:function(){c.resetForm(this)},after_close:b})},resetForm:function(a){var b=a.content||$(".fancybox-inner");b.parent().find("form").each(function(){this.reset();$(this).find(".error, .success").hide()})}};jQuery(document).ready(function(a){if(typeof a.fancybox=="function"){pl_showing_request.init()}var b=_placester.entitlementsHandler.shouldFireFbPixelLeadEvent();var c=_placester&&_placester.fbPixelConfig&&_placester.fbPixelConfig.fb_pixel_id?true:false;function d(){a(".datepicker").datepicker({dateFormat:"mm/dd/yy",dayNamesMin:["S","M","T","W","T","F","S"],minDate:0})}a(window).bind("load",function(){d()});a(document).on("click","#addAnotherTime",function(b){d();a(".startTimeChosen").chosen({allow_single_deselect:true,width:"100%"});a(".endTimeChosen").chosen({allow_single_deselect:true,width:"100%"})});var e=function(a){a.find('input[type="text"], input[type="email"], input[type="date"], input[type="time"], textarea').val("")};try{var f=Intl.DateTimeFormat().resolvedOptions().timeZone}catch(p){a("#user_timezone").val("")}if(f){a("#user_timezone").val(f)}else{a("#user_timezone").val("")}a(function(){a(document).on("click","#removeTime",function(b){a(this).closest(".showingTimeDetails").remove()})});var g='<option value="08:00">8:00AM</option>'+'<option value="08:30">8:30AM</option>'+'<option value="09:00">9:00AM</option>'+'<option value="09:30">9:30AM</option>'+'<option value="10:00">10:00AM</option>'+'<option value="10:30">10:30AM</option>'+'<option value="11:00">11:00AM</option>'+'<option value="11:30">11:30AM</option>'+'<option value="12:00">12:00PM</option>'+'<option value="12:30">12:30PM</option>'+'<option value="13:00">1:00PM</option>'+'<option value="13:30">1:30PM</option>'+'<option value="14:00">2:00PM</option>'+'<option value="14:30">2:30PM</option>'+'<option value="15:00">3:00PM</option>'+'<option value="15:30">3:30PM</option>'+'<option value="16:00">4:00PM</option>'+'<option value="16:30">4:30PM</option>'+'<option value="17:00">5:00PM</option>'+'<option value="17:30">5:30PM</option>'+'<option value="18:00">6:00PM</option>'+'<option value="18:30">6:30PM</option>'+'<option value="19:00">7:00PM</option>'+'<option value="19:30">7:30PM</option>'+'<option value="20:00">8:00PM</option>'+'<option value="20:30">8:30PM</option>'+'<option value="21:00">9:00PM</option>'+'<option value="21:30">9:30PM</option>'+'<option value="22:00">10:00PM</option>';var h='<div class="showingTimeDetails">';var i='<div class="pl_widget-showingRequest--showingDay">'+'<label class="requestShowingLabel" for="showing_day">'+getLocalizedText("Day","showingRequest.day")+"</label>"+'<input type="text" name="showing_day[]" required="required" autocomplete="off" class="datepicker" placeholder="mm/dd/yyyy">'+'<i class="material-icons md-18 grey-text">event</i>'+"</div>";var j='<div class="pl_widget-showingRequest--availableStart">'+'<label class="requestShowingLabel" for="available_start">'+getLocalizedText("Available Start","showingRequest.availableStart")+"</label>"+'<div class="pl_flex-input">'+'<select class="startTimeChosen" name="start_time[]" required="required">'+g+"</select>"+'<i class="material-icons md-18 grey-text">query_builder</i>'+"</div>"+"</div>";var k='<div class="pl_widget-showingRequest--availableEnd">'+'<label class="requestShowingLabel" for="available_end">'+getLocalizedText("Available End","showingRequest.availableEnd")+"</label>"+'<div class="pl_flex-input">'+'<select class="endTimeChosen" name="end_time[]" required="required">'+g+"</select>"+'<i class="material-icons md-18 grey-text">query_builder</i>'+"</div>"+"</div>";var l='<div class="pl_widget-showingRequest--removeTime">'+'<a id="removeTime" href="#">'+getLocalizedText("REMOVE","showingRequest.remove")+"</a>"+"</div>";var m="</div>";var n=h+i+j+k+m;var o=h+i+j+k+l+m;a(function(){a("#showingTimes").append(n)});a(function(){a("#addAnotherTime").click(function(b){a("#showingTimes").append("\n"+o)})});a(function(){a(document).on("submit",".pl_widget-showingRequest form",function(d){var f=a(this).parent();var g=a(this).serialize();var h=a(this).data("uii");var i=a(this);d.preventDefault();f.find(".error").hide();if(a(".invalid",this).length){return false}f.find(".pl_widget-showingRequest--formLoading").show();jQuery.ajax({type:"POST",url:info.ajaxurl,data:"action=placester_showing_request&"+g,dataType:"json",success:function(a){if(a.error===""){if(c&&b){try{fbq("track","Lead")}catch(p){console.warn("Error tracking Facebook Pixel event.")}}f.find(".pl_widget-showingRequest--formLoading").fadeOut("fast");if(typeof pl_inject_conversion_snippet==="function")pl_inject_conversion_snippet();i.addClass("form_submitted");i.find('input[type="submit"]').val("Sent!");e(i);i.find(".form-validator-error").remove();i.slideUp();setTimeout(function(){f.find(".success").show("fast");i.find("input[name='form_submitted']").val(1)},500);if(typeof _placester.uii==="object"&&a.lead_uuid){_placester.uii.addToPayLoad("lead_uuid",a.lead_uuid,true);_placester.uii.send({event:h,interaction_data:{action:"submit-success",result:a,element_data_type:"target",element_data:_placester.uii.getElementData(i.get(0))},form_data:_placester.uii.formSerializer(i.get(0))})}}else{f.find(".pl_widget-showingRequest--formLoading").hide();f.find(".error").html(a.error).show("fast");if(typeof _placester.uii==="object"){_placester.uii.send({event:h,interaction_data:{action:"submit-error",result:a,element_data_type:"target",element_data:_placester.uii.getElementData(i.get(0))},form_data:_placester.uii.formSerializer(i.get(0))})}}}})})})});function Status_Window(a){var b=this;this.params=a;if(typeof a==="undefined")alert("You need to pass in parameters");this.listings=a.listings||alert("You must attach a listings object to your status object");this.map=this.listings.map||alert("You need to attach a map to the listings object if you want the status object actually work");this.filter_position=a.fitler_position||google.maps.ControlPosition.RIGHT_TOP;this.className=a["class"]||"map_filter_area";this.dom_id=a.dom_id||"map_filter_area";this.on_load=a.on_load||false;this.some_results=a.some_results||false;this.empty=a.empty||false;this.loading=a.loading||false;this.update_map_on_drag=false;this.prompt_map_on_drag=false;this.title=false;this.body=false;this.footer=false;this.active_title=false;this.active_body=false;this.active_footer=false}Status_Window.prototype.init=function(){if(this.map.type=="listings"){this.listings_init()}else if(this.map.type=="neighborhood"){this.neighborhood_init()}else if(this.map.type=="lifestyle"){this.lifestyle_init()}else if(this.map.type=="lifestyle_polygon"){this.initalize_lifestyle_polygon_init()}};Status_Window.prototype.neightborhood_init=function(){};Status_Window.prototype.lifestyle_init=function(){};Status_Window.prototype.lifestyle_polygon_init=function(){};Status_Window.prototype.listings_init=function(){var a=this;this.on_load=this.params.on_load||function(){a.title="<h4>First Load</h4>";a.body="Some text that needs to be long";a.footer=a.drag_reload_modal();a.update()};this.some_results=this.params.some_results||function(){a.title="<h4>You have Results!</h4>";a.body="Some text that needs to be long";a.update()};this.empty=this.params.empty||function(){a.title="<h4>Empty!</h4>";a.body="Some text that needs to be long";a.update()};this.loading=this.params.loading||function(){a.title="<h4>Loading</h4>";a.body="New listings are on the way!";a.update()};this.dragging=this.params.dragging||function(){a.title="<h4>You are dragging</h4>";a.body="Let go to see new listings";a.update()};this.full=this.params.full||function(){a.title="<h4>Zoom In</h4>";a.body="Full here! Try zooming in.";a.update()};this.listeners=this.params.listeners||function(){jQuery("#polygon_unselect").on("click",function(){a.unselect_polygon()})}()};Status_Window.prototype.neighborhood_init=function(){var a=this;this.on_load=this.params.on_load||function(){a.title="<h4>First Load</h4>";a.body="Some text that needs to be long";a.footer="Just another footer";a.update()};this.some_results=this.params.some_results||function(){a.title="<h4>You have Results!</h4>";a.body="Some text that needs to be long";a.update()};this.empty=this.params.empty||function(){a.title="<h4>Empty!</h4>";a.body="Some text that needs to be long";a.update()};this.loading=this.params.loading||function(){a.title="<h4>Loading</h4>";a.body="New listings are on the way!";a.update()};this.dragging=this.params.dragging||function(){a.title="<h4>You are dragging</h4>";a.body="Let go to see new listings";a.update()};this.full=this.params.full||function(){a.title="<h4>Zoom In</h4>";a.body="Full here! Try zooming in.";a.update()};this.listeners=this.params.listeners||function(){jQuery("#polygon_unselect").on("click",function(){a.unselect_polygon()})}()};Status_Window.prototype.lifestyle=function(){var a=this;this.on_load=this.params.on_load||function(){a.title="<h4>First Load</h4>";a.body="Some text that needs to be long";a.footer="Just another footer";a.update()};this.some_results=this.params.some_results||function(){a.title="<h4>You have Results!</h4>";a.body="Some text that needs to be long";a.update()};this.empty=this.params.empty||function(){a.title="<h4>Empty!</h4>";a.body="Some text that needs to be long";a.update()};this.loading=this.params.loading||function(){a.title="<h4>Loading</h4>";a.body="New listings are on the way!";a.update()};this.dragging=this.params.dragging||function(){a.title="<h4>You are dragging</h4>";a.body="Let go to see new listings";a.update()};this.full=this.params.full||function(){a.title="<h4>Zoom In</h4>";a.body="Full here! Try zooming in.";a.update()};this.listeners=this.params.listeners||function(){jQuery("#polygon_unselect").on("click",function(){a.unselect_polygon()})}()};Status_Window.prototype.lifestyle_polygon=function(){var a=this;this.on_load=this.params.on_load||function(){a.title="<h4>First Load</h4>";a.body="Some text that needs to be long";a.footer="Just another footer";a.update()};this.some_results=this.params.some_results||function(){a.title="<h4>You have Results!</h4>";a.body="Some text that needs to be long";a.update()};this.empty=this.params.empty||function(){a.title="<h4>Empty!</h4>";a.body="Some text that needs to be long";a.update()};this.loading=this.params.loading||function(){a.title="<h4>Loading</h4>";a.body="New listings are on the way!";a.update()};this.dragging=this.params.dragging||function(){a.title="<h4>You are dragging</h4>";a.body="Let go to see new listings";a.update()};this.full=this.params.full||function(){a.title="<h4>Zoom In</h4>";a.body="Full here! Try zooming in.";a.update()};this.listeners=this.params.listeners||function(){jQuery("#polygon_unselect").on("click",function(){a.unselect_polygon()})}()};Status_Window.prototype.update=function(){if(!this.active_title||this.active_title!=this.title){jQuery("#title_wrapper").html(this.title);this.active_title=this.title}if(!this.active_body||this.active_body!=this.body){jQuery("#body_wrapper").html(this.body);this.active_body=this.body}if(!this.active_footer||this.active_footer!=this.footer){jQuery("#footer_wrapper").html(this.footer);this.active_footer=this.footer}};Status_Window.prototype.add_control_container=function(a){var b=this;var c=document.createElement("div");c.id=this.dom_id+a;c.className=this.className;c.style.marginTop="9px";c.style.marginRight="7px";c.style.padding="5px";var d=document.createElement("div");d.id="map_filter_area_wrapper";var e=document.createElement("div");e.id="title_wrapper";d.appendChild(e);var f=document.createElement("div");f.id="body_wrapper";d.appendChild(f);var g=document.createElement("div");g.id="footer_wrapper";d.appendChild(g);c.appendChild(d);b.map.map.controls[b.filter_position].push(c)};Status_Window.prototype.unselect_polygon=function(){console.log(this);this.map.selected_polygon=false;this.listings.get();this.map.center_on_polygons();this.on_load()};Status_Window.prototype.drag_reload_modal=function(){var a=this;var b="_donkey";jQuery("#update_map_on_drag").on("click",function(b){if(jQuery(this).attr("checked")){a.update_map_on_drag=true}else{a.update_map_on_drag=false}});google.maps.event.addListenerOnce(a.map.map,"drag",function(){if(!a.prompt_map_on_drag){a.prompt_map_on_drag=true;a.add_control_container(b);jQuery("#"+a.dom_id+b+" #title_wrapper").html("<h4>Hey Map Searcher</h4>");jQuery("#"+a.dom_id+b+" #body_wrapper").html('<p>Do you want to reload the map after drags?</p><p><a id="reload_map_yes">Yes</a><a id="reload_map_no">No</a></p>')}jQuery("#"+a.dom_id+b+" #body_wrapper #reload_map_no").on("click",function(){a.update_map_on_drag=false;jQuery("#update_map_on_drag").attr("checked",0);jQuery("#"+a.dom_id+b).remove()});jQuery("#"+a.dom_id+b+" #body_wrapper #reload_map_yes").on("click",function(){jQuery("#update_map_on_drag").attr("checked",1);a.listings.get();a.update_map_on_drag=true;jQuery("#"+a.dom_id+b).remove()})});return'<input id="update_map_on_drag" type="checkbox"/><label>Redo search when map is dragged</label>'};Status_Window.prototype.get_formatted_filters=function(){var a=this.listings.active_filters;var b=[];for(var c=a.length-1;c>=0;c--){if(jQuery.inArray(a[c].name,["metadata[beds]"])===-1||a[c].value=="")continue;if(this.filter_translation[a[c].name])a[c].name=this.filter_translation[a[c].name];b.push({name:a[c].name,value:a[c].value})}return b};(function(a){window.pl_timezones=[{value:"Eastern Standard Time",abbr:"EST",tzinfo:"America/New_York",offset:-5,isdst:true,text:"(GMT-05:00) Eastern Time (US & Canada)"},{value:"Central Time Zone",abbr:"CST",tzinfo:"America/Chicago",offset:-6,isdst:true,text:"(GMT-06:00) Central Time (US & Canada)"},{value:"Mountain Standard Time",abbr:"MST",tzinfo:"America/Denver",offset:-7,isdst:true,text:"(GMT-07:00) Mountain Time (US & Canada)"},{value:"Pacific Standard Time",abbr:"PST",tzinfo:"America/Los_Angeles",offset:-8,isdst:true,text:"(GMT-08:00) Pacific Time (US & Canada)"},{value:"Alaskan Standard Time",abbr:"AKDT",tzinfo:"America/Anchorage",offset:-9,isdst:true,text:"(GMT-09:00) Alaska Time"},{value:"Hawaiian Standard Time",abbr:"HST",tzinfo:"Pacific/Honolulu",offset:-10,isdst:false,text:"(GMT-10:00) Hawaii Time"},{value:"Argentina Time",abbr:"ART",tzinfo:"America/Argentina/Buenos_Aires",offset:-3,isdst:false,text:"(GMT -03:00) Argentina Time"},{value:"Argentina Time",abbr:"ART",tzinfo:"America/Buenos_Aires",offset:-3,isdst:false,text:"(GMT -03:00) Argentina Time"},{value:"Atlantic Standard Time",abbr:"AST",tzinfo:"America/Halifax",offset:-4,isdst:true,text:"(GMT -04:00) Atlantic Standard Time"},{value:"Newfoundland Standard Time",abbr:"NST",tzinfo:"America/St_Johns",offset:-3.5,isdst:true,text:"(GMT -03:30) Newfoundland Standard Time"}];window.pl_fetch_date_for_post=function a(b,c){var d;var e;if(!b||!b.timezone){d=moment.tz.guess()}else{e=b.timezone[0]}if(!d){for(var f=0;f<pl_timezones.length;f++){if(pl_timezones[f].abbr===e){d=pl_timezones[f].tzinfo;break}}}var g=this.pl_stringDateToMoment(c);var h=[g.year(),g.month(),g.date(),g.hour(),g.minute(),g.second()];var i=moment.tz(moment.tz(h,d)._d,d);var j={year:"numeric",month:"long",day:"numeric"};var k=new Date(i._d);var l=k.toLocaleDateString("en-US",j);return l};window.pl_stringDateToMoment=function a(b){var c=b.split(" ");var d=c[0].split("-");var e=c[1].split(".")[0].split(":");var f=moment();f.year(d[0]);f.month(d[1]-1);f.date(d[2]);f.hour(e[0]);f.minute(e[1]);f.second(e[2]);return f}})(jQuery);